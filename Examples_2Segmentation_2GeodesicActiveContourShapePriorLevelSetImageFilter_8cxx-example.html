<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ITK: Examples/Segmentation/GeodesicActiveContourShapePriorLevelSetImageFilter.cxx</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="ITK"/>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<script type="text/javascript" src="build_text.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ITKDoxygenStyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="itkLogoSmall.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ITK
   &#160;<span id="projectnumber">5.3.0</span>
   </div>
   <div id="projectbrief">Insight Toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--  Scripts intended to allow users to submit patches with documentation fixes -->
<!-- <script src="https://www.itk.org/Doxygen/js/jquery-1.4.3.min.js" type="text/javascript" charset="utf-8"></script> -->
<!-- <script src="https://www.itk.org/Doxygen/js/editdoxygen.js" type="text/javascript" charset="utf-8"></script> -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,true,'search.php','Search');
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Examples/Segmentation/GeodesicActiveContourShapePriorLevelSetImageFilter.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*=========================================================================</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Copyright NumFOCUS</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment"> *  you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment"> *  You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *         http://www.apache.org/licenses/LICENSE-2.0.txt</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment"> *  See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment"> *  limitations under the License.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *=========================================================================*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In medical imaging applications, the general shape, location and</span></div>
<div class="line"><span class="comment">// orientation of an anatomical structure of interest is typically</span></div>
<div class="line"><span class="comment">// known \emph{a priori}. This information can be used to aid the</span></div>
<div class="line"><span class="comment">// segmentation process especially when image contrast is low or</span></div>
<div class="line"><span class="comment">// when the object boundary is not distinct.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In \cite{Leventon2000}, Leventon \emph{et al.} extended the</span></div>
<div class="line"><span class="comment">// geodesic active contours method with an additional shape-influenced term in</span></div>
<div class="line"><span class="comment">// the driving PDE. The</span></div>
<div class="line"><span class="comment">// \doxygen{GeodesicActiveContourShapePriorLevelSetImageFilter} is a</span></div>
<div class="line"><span class="comment">// generalization of Leventon&#39;s approach and its use is illustrated in the</span></div>
<div class="line"><span class="comment">// following example.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// To support shape-guidance, the generic level set</span></div>
<div class="line"><span class="comment">// equation (Eqn(~\ref{eqn:LevelSetEquation})) is extended to incorporate a</span></div>
<div class="line"><span class="comment">// shape guidance term:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// \begin{equation}</span></div>
<div class="line"><span class="comment">// \label{eqn:ShapeInfluenceTerm}</span></div>
<div class="line"><span class="comment">// \xi \left(\psi^{*}(\mathbf{x}) - \psi(\mathbf{x})\right)</span></div>
<div class="line"><span class="comment">// \end{equation}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// where $\psi^{*}$ is the signed distance function of the ``best-fit&#39;&#39; shape</span></div>
<div class="line"><span class="comment">// with respect to a shape model. The new term has the effect of driving the</span></div>
<div class="line"><span class="comment">// contour towards the best-fit shape. The scalar $\xi$ weights the influence</span></div>
<div class="line"><span class="comment">// of the shape term in the overall evolution. In general, the best-fit shape</span></div>
<div class="line"><span class="comment">// is not known ahead of time and has to be iteratively estimated in</span></div>
<div class="line"><span class="comment">// conjunction with the contour evolution.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// As with the \doxygen{GeodesicActiveContourLevelSetImageFilter}, the</span></div>
<div class="line"><span class="comment">// GeodesicActiveContourShapePriorLevelSetImageFilter expects two input</span></div>
<div class="line"><span class="comment">// images: the first is an initial level set and the second a feature image</span></div>
<div class="line"><span class="comment">// that represents the image edge potential. The configuration of this</span></div>
<div class="line"><span class="comment">// example is quite similar to the example in</span></div>
<div class="line"><span class="comment">// Section~\ref{sec:GeodesicActiveContourImageFilter} and hence the</span></div>
<div class="line"><span class="comment">// description will focus on the new objects involved in the segmentation</span></div>
<div class="line"><span class="comment">// process as shown in</span></div>
<div class="line"><span class="comment">// Figure~\ref{fig:GeodesicActiveContourShapePriorCollaborationDiagram}.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// \begin{figure} \center</span></div>
<div class="line"><span class="comment">// \includegraphics[width=\textwidth]{GeodesicActiveContourShapePriorCollaborationDiagram}</span></div>
<div class="line"><span class="comment">// \itkcaption[GeodesicActiveContourShapePriorLevelSetImageFilter</span></div>
<div class="line"><span class="comment">// collaboration diagram]{Collaboration diagram for the</span></div>
<div class="line"><span class="comment">// GeodesicActiveContourShapePriorLevelSetImageFilter applied to a</span></div>
<div class="line"><span class="comment">// segmentation task.}</span></div>
<div class="line"><span class="comment">// \label{fig:GeodesicActiveContourShapePriorCollaborationDiagram}</span></div>
<div class="line"><span class="comment">// \end{figure}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The process pipeline begins with centering the input image using the</span></div>
<div class="line"><span class="comment">// the \doxygen{ChangeInformationImageFilter} to simplify the estimation of</span></div>
<div class="line"><span class="comment">// the pose of the shape, to be explained later. The centered image is then</span></div>
<div class="line"><span class="comment">// smoothed using non-linear diffusion to remove noise and the gradient</span></div>
<div class="line"><span class="comment">// magnitude is computed from the smoothed image. For simplicity, this example</span></div>
<div class="line"><span class="comment">// uses the \doxygen{BoundedReciprocalImageFilter} to produce the edge</span></div>
<div class="line"><span class="comment">// potential image.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The \doxygen{FastMarchingImageFilter} creates an initial level set using</span></div>
<div class="line"><span class="comment">// three user specified seed positions and an initial contour radius. Three</span></div>
<div class="line"><span class="comment">// seeds are used in this example to facilitate the segmentation of long</span></div>
<div class="line"><span class="comment">// narrow objects in a smaller number of iterations. The output of the</span></div>
<div class="line"><span class="comment">// FastMarchingImageFilter is passed as the input to the</span></div>
<div class="line"><span class="comment">// GeodesicActiveContourShapePriorLevelSetImageFilter. At then end of the</span></div>
<div class="line"><span class="comment">// segmentation process, the output level set is passed to the</span></div>
<div class="line"><span class="comment">// \doxygen{BinaryThresholdImageFilter} to produce a binary mask representing</span></div>
<div class="line"><span class="comment">// the segmented object.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The remaining objects in</span></div>
<div class="line"><span class="comment">// Figure~\ref{fig:GeodesicActiveContourShapePriorCollaborationDiagram}</span></div>
<div class="line"><span class="comment">// are used for shape modeling and estimation.</span></div>
<div class="line"><span class="comment">// The \doxygen{PCAShapeSignedDistanceFunction} represents a statistical</span></div>
<div class="line"><span class="comment">// shape model defined by a mean signed distance and the first $K$</span></div>
<div class="line"><span class="comment">// principal components modes; while the \doxygen{Euler2DTransform} is used</span></div>
<div class="line"><span class="comment">// to represent the pose of the shape. In this implementation, the</span></div>
<div class="line"><span class="comment">// best-fit shape estimation problem is reformulated as a minimization problem</span></div>
<div class="line"><span class="comment">// where the \doxygen{ShapePriorMAPCostFunction} is the cost function to</span></div>
<div class="line"><span class="comment">// be optimized using the \doxygen{OnePlusOneEvolutionaryOptimizer}.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// It should be noted that, although particular shape model, transform</span></div>
<div class="line"><span class="comment">// cost function, and optimizer are used in this example, the implementation</span></div>
<div class="line"><span class="comment">// is generic, allowing different instances of these components to be</span></div>
<div class="line"><span class="comment">// plugged in. This flexibility allows a user to tailor the behavior of the</span></div>
<div class="line"><span class="comment">// segmentation process to suit the circumstances of the targeted application.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Let&#39;s start the example by including the headers of the new filters</span></div>
<div class="line"><span class="comment">// involved in the segmentation.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkGeodesicActiveContourShapePriorLevelSetImageFilter_8h.html">itkGeodesicActiveContourShapePriorLevelSetImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkChangeInformationImageFilter_8h.html">itkChangeInformationImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkBoundedReciprocalImageFilter_8h.html">itkBoundedReciprocalImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Next, we include the headers of the objects involved in shape</span></div>
<div class="line"><span class="comment">//  modeling and estimation.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkPCAShapeSignedDistanceFunction_8h.html">itkPCAShapeSignedDistanceFunction.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkEuler2DTransform_8h.html">itkEuler2DTransform.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkOnePlusOneEvolutionaryOptimizer_8h.html">itkOnePlusOneEvolutionaryOptimizer.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkNormalVariateGenerator_8h.html">itkNormalVariateGenerator.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkNumericSeriesFileNames_8h.html">itkNumericSeriesFileNames.h</a>&quot;</span></div>
<div class="line"><span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkCurvatureAnisotropicDiffusionImageFilter_8h.html">itkCurvatureAnisotropicDiffusionImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkGradientMagnitudeRecursiveGaussianImageFilter_8h.html">itkGradientMagnitudeRecursiveGaussianImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkFastMarchingImageFilter_8h.html">itkFastMarchingImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkRescaleIntensityImageFilter_8h.html">itkRescaleIntensityImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkBinaryThresholdImageFilter_8h.html">itkBinaryThresholdImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkImageFileReader_8h.html">itkImageFileReader.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkImageFileWriter_8h.html">itkImageFileWriter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkSpatialFunctionImageEvaluatorFilter_8h.html">itkSpatialFunctionImageEvaluatorFilter.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Given the numerous parameters involved in tuning this segmentation method</span></div>
<div class="line"><span class="comment">// it is not uncommon for a segmentation process to</span></div>
<div class="line"><span class="comment">// run for several minutes and still produce an unsatisfactory result. For</span></div>
<div class="line"><span class="comment">// debugging purposes it is quite helpful to track the evolution of the</span></div>
<div class="line"><span class="comment">// segmentation as it progresses. The following defines a</span></div>
<div class="line"><span class="comment">// custom \doxygen{Command} class</span></div>
<div class="line"><span class="comment">// for monitoring the RMS change and shape parameters at each iteration.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  \index{itk::Geodesic\-Active\-Contour\-Shape\-Prior\-LevelSet\-Image\-Filter!Monitoring}</span></div>
<div class="line"><span class="comment">//  \index{itk::Shape\-Prior\-Segmentation\-Level\-Set\-Image\-Filter!Monitoring}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkCommand_8h.html">itkCommand.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> TFilter&gt;</div>
<div class="line"><span class="keyword">class </span>CommandIterationUpdate : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="classitk_1_1Command.html">itk::Command</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">using</span> <a name="_a1"></a><a class="code" href="classAddImageFilter.html">Self</a> = CommandIterationUpdate;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="itkAddImageFilter_8h.html#a8c77390f5f26f2ec5a75801152e1f673">Superclass</a> = <a name="a2"></a><a class="code" href="namespaceitk.html#af2b97d337bf8035236a54a91fdcf040a">itk::Command</a>;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="itkAddImageFilter_8h.html#ac831674d6d3f7cd2148ae944cbaa7c9d">Pointer</a> = <a name="_a3"></a><a class="code" href="classitk_1_1SmartPointer.html">itk::SmartPointer&lt;Self&gt;</a>;</div>
<div class="line">  itkNewMacro(<a class="code" href="classAddImageFilter.html">Self</a>);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  CommandIterationUpdate() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a name="a4"></a><a class="code" href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">Execute</a>(<a name="_a5"></a><a class="code" href="classitk_1_1Object.html">itk::Object</a> * caller, <span class="keyword">const</span> <a name="_a6"></a><a class="code" href="classitk_1_1EventObject.html">itk::EventObject</a> &amp; event)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">Execute</a>((<span class="keyword">const</span> <a class="code" href="classitk_1_1Object.html">itk::Object</a> *)caller, event);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a class="code" href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">Execute</a>(<span class="keyword">const</span> <a class="code" href="classitk_1_1Object.html">itk::Object</a> * <span class="keywordtype">object</span>, <span class="keyword">const</span> <a class="code" href="classitk_1_1EventObject.html">itk::EventObject</a> &amp; event)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> * filter = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>TFilter *<span class="keyword">&gt;</span>(object);</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">typeid</span>(event) != <span class="keyword">typeid</span>(itk::IterationEvent))</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; filter-&gt;GetElapsedIterations() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; filter-&gt;GetRMSChange() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; filter-&gt;GetCurrentParameters() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (argc &lt; 18)</div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Missing Parameters &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0];</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; inputImage  outputImage&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; seed1X seed1Y&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; seed2X seed2Y&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; seed3X seed3Y&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; initialDistance&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; sigma&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; propagationScaling shapePriorScaling&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; meanShapeImage numberOfModes shapeModeFilePattern&quot;</span>;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot; startX startY&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  We define the image type using a particular pixel type and</span></div>
<div class="line">  <span class="comment">//  dimension. In this case we will use 2D \code{float} images.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> InternalPixelType = float;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a name="a7"></a><a class="code" href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#a3c1343e7d285fc01106df9e0c28d5154">Dimension</a> = 2;</div>
<div class="line">  <span class="keyword">using</span> InternalImageType = <a name="_a8"></a><a class="code" href="classitk_1_1Image.html">itk::Image&lt;InternalPixelType, Dimension&gt;</a>;</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The following lines instantiate the thresholding filter that will</span></div>
<div class="line">  <span class="comment">//  process the final level set at the output of the</span></div>
<div class="line">  <span class="comment">//  GeodesicActiveContourLevelSetImageFilter.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> OutputPixelType = <span class="keywordtype">unsigned</span> char;</div>
<div class="line">  <span class="keyword">using</span> OutputImageType = <a class="code" href="classitk_1_1Image.html">itk::Image&lt;OutputPixelType, Dimension&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> ThresholdingFilterType =</div>
<div class="line">    <a name="_a9"></a><a class="code" href="classitk_1_1BinaryThresholdImageFilter.html">itk::BinaryThresholdImageFilter&lt;InternalImageType, OutputImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> thresholder = <a name="a10"></a><a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">ThresholdingFilterType::New</a>();</div>
<div class="line"> </div>
<div class="line">  thresholder-&gt;SetLowerThreshold(-1000.0);</div>
<div class="line">  thresholder-&gt;SetUpperThreshold(0.0);</div>
<div class="line"> </div>
<div class="line">  thresholder-&gt;SetOutsideValue(0);</div>
<div class="line">  thresholder-&gt;SetInsideValue(255);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// We instantiate reader and writer types in the following lines.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> ReaderType = <a name="_a11"></a><a class="code" href="classitk_1_1ImageFileReader.html">itk::ImageFileReader&lt;InternalImageType&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> WriterType = <a name="_a12"></a><a class="code" href="classitk_1_1ImageFileWriter.html">itk::ImageFileWriter&lt;OutputImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> reader = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">ReaderType::New</a>();</div>
<div class="line">  <span class="keyword">auto</span> writer = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">WriterType::New</a>();</div>
<div class="line"> </div>
<div class="line">  reader-&gt;SetFileName(argv[1]);</div>
<div class="line">  writer-&gt;SetFileName(argv[2]);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The RescaleIntensityImageFilter type is declared below. This filter will</span></div>
<div class="line">  <span class="comment">//  renormalize image before sending them to writers.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> CastFilterType =</div>
<div class="line">    <a name="_a13"></a><a class="code" href="classitk_1_1RescaleIntensityImageFilter.html">itk::RescaleIntensityImageFilter&lt;InternalImageType, OutputImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The \doxygen{CurvatureAnisotropicDiffusionImageFilter} type is</span></div>
<div class="line">  <span class="comment">//  instantiated using the internal image type.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> SmoothingFilterType =</div>
<div class="line">    <a name="_a14"></a><a class="code" href="classitk_1_1CurvatureAnisotropicDiffusionImageFilter.html">itk::CurvatureAnisotropicDiffusionImageFilter</a>&lt;InternalImageType,</div>
<div class="line">                                                  InternalImageType&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> smoothing = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">SmoothingFilterType::New</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The types of the</span></div>
<div class="line">  <span class="comment">//  GradientMagnitudeRecursiveGaussianImageFilter is</span></div>
<div class="line">  <span class="comment">//  instantiated using the internal image type.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> GradientFilterType =</div>
<div class="line">    <a name="_a15"></a><a class="code" href="classitk_1_1GradientMagnitudeRecursiveGaussianImageFilter.html">itk::GradientMagnitudeRecursiveGaussianImageFilter</a>&lt;InternalImageType,</div>
<div class="line">                                                       InternalImageType&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> gradientMagnitude = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">GradientFilterType::New</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  We declare now the type of the FastMarchingImageFilter that</span></div>
<div class="line">  <span class="comment">//  will be used to generate the initial level set in the form of a distance</span></div>
<div class="line">  <span class="comment">//  map.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> FastMarchingFilterType =</div>
<div class="line">    <a name="_a16"></a><a class="code" href="classitk_1_1FastMarchingImageFilter.html">itk::FastMarchingImageFilter&lt;InternalImageType, InternalImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Next we construct one filter of this class using the \code{New()}</span></div>
<div class="line">  <span class="comment">//  method.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">auto</span> fastMarching = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">FastMarchingFilterType::New</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The following line instantiate a</span></div>
<div class="line">  <span class="comment">//  \doxygen{GeodesicActiveContourShapePriorLevelSetImageFilter}</span></div>
<div class="line">  <span class="comment">//  using the \code{New()} method.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> GeodesicActiveContourFilterType =</div>
<div class="line">    <a name="_a17"></a><a class="code" href="classitk_1_1GeodesicActiveContourShapePriorLevelSetImageFilter.html">itk::GeodesicActiveContourShapePriorLevelSetImageFilter</a>&lt;</div>
<div class="line">      InternalImageType,</div>
<div class="line">      InternalImageType&gt;;</div>
<div class="line">  <span class="keyword">auto</span> geodesicActiveContour = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">GeodesicActiveContourFilterType::New</a>();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// The \doxygen{ChangeInformationImageFilter} is the first filter in the</span></div>
<div class="line">  <span class="comment">// preprocessing stage and is used to force the image origin to the center</span></div>
<div class="line">  <span class="comment">// of the image.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::ChangeInformationImageFilter!CenterImageOn()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> CenterFilterType =</div>
<div class="line">    <a name="_a18"></a><a class="code" href="classitk_1_1ChangeInformationImageFilter.html">itk::ChangeInformationImageFilter&lt;InternalImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> center = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">CenterFilterType::New</a>();</div>
<div class="line">  center-&gt;CenterImageOn();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// In this example, we will use the bounded reciprocal $1/(1+x)$ of</span></div>
<div class="line">  <span class="comment">// the image gradient magnitude as the edge potential feature image.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> ReciprocalFilterType =</div>
<div class="line">    <a name="_a19"></a><a class="code" href="classitk_1_1BoundedReciprocalImageFilter.html">itk::BoundedReciprocalImageFilter&lt;InternalImageType, InternalImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> reciprocal = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">ReciprocalFilterType::New</a>();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  In the GeodesicActiveContourShapePriorLevelSetImageFilter, scaling</span></div>
<div class="line">  <span class="comment">//  parameters are used to trade off between the propagation (inflation),</span></div>
<div class="line">  <span class="comment">//  the curvature (smoothing), the advection, and the shape influence terms.</span></div>
<div class="line">  <span class="comment">//  These parameters are set</span></div>
<div class="line">  <span class="comment">//  using methods \code{SetPropagationScaling()},</span></div>
<div class="line">  <span class="comment">//  \code{SetCurvatureScaling()}, \code{SetAdvectionScaling()} and</span></div>
<div class="line">  <span class="comment">//  \code{SetShapePriorScaling()}. In this</span></div>
<div class="line">  <span class="comment">//  example, we will set the curvature and advection scales to one and let</span></div>
<div class="line">  <span class="comment">//  the propagation and shape prior scale be command-line arguments.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Geodesic\-Active\-Contour\-Shape\-Prior\-LevelSet\-Image\-Filter!SetPropagationScaling()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Shape\-Prior\-Segmentation\-Level\-Set\-Image\-Filter!SetPropagationScaling()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Geodesic\-Active\-Contour\-Shape\-Prior\-LevelSet\-Image\-Filter!SetCurvatureScaling()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Shape\-Prior\-Segmentation\-Level\-Set\-Image\-Filter!SetCurvatureScaling()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Geodesic\-Active\-Contour\-Shape\-Prior\-LevelSet\-Image\-Filter!SetAdvectionScaling()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Shape\-Prior\-Segmentation\-Level\-Set\-Image\-Filter!SetAdvectionScaling()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> propagationScaling = std::stod(argv[11]);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> shapePriorScaling = std::stod(argv[12]);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  geodesicActiveContour-&gt;SetPropagationScaling(propagationScaling);</div>
<div class="line">  geodesicActiveContour-&gt;SetShapePriorScaling(shapePriorScaling);</div>
<div class="line">  geodesicActiveContour-&gt;SetCurvatureScaling(1.0);</div>
<div class="line">  geodesicActiveContour-&gt;SetAdvectionScaling(1.0);</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Once activiated the level set evolution will stop if the convergence</span></div>
<div class="line">  <span class="comment">//  criteria or if the maximum number of iterations is reached.  The</span></div>
<div class="line">  <span class="comment">//  convergence criteria is defined in terms of the root mean squared (RMS)</span></div>
<div class="line">  <span class="comment">//  change in the level set function. The evolution is said to have</span></div>
<div class="line">  <span class="comment">//  converged if the RMS change is below a user specified threshold.  In a</span></div>
<div class="line">  <span class="comment">//  real application is desirable to couple the evolution of the zero set</span></div>
<div class="line">  <span class="comment">//  to a visualization module allowing the user to follow the evolution of</span></div>
<div class="line">  <span class="comment">//  the zero set. With this feedback, the user may decide when to stop the</span></div>
<div class="line">  <span class="comment">//  algorithm before the zero set leaks through the regions of low gradient</span></div>
<div class="line">  <span class="comment">//  in the contour of the anatomical structure to be segmented.</span></div>
<div class="line"> </div>
<div class="line">  geodesicActiveContour-&gt;SetMaximumRMSError(0.005);</div>
<div class="line">  geodesicActiveContour-&gt;SetNumberOfIterations(400);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Each iteration, the current ``best-fit&#39;&#39; shape is estimated from the</span></div>
<div class="line">  <span class="comment">//  edge potential image and the current contour. To increase speed, only</span></div>
<div class="line">  <span class="comment">//  information within the sparse field layers of the current contour is</span></div>
<div class="line">  <span class="comment">//  used in the estimation. The default number of sparse field layers is the</span></div>
<div class="line">  <span class="comment">//  same as the ImageDimension which does not contain enough information to</span></div>
<div class="line">  <span class="comment">//  get a reliable best-fit shape estimate. Thus, we override the default</span></div>
<div class="line">  <span class="comment">//  and set the number of layers to 4.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  geodesicActiveContour-&gt;SetNumberOfLayers(4);</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The filters are then connected in a pipeline as illustrated in</span></div>
<div class="line">  <span class="comment">//  Figure~\ref{fig:GeodesicActiveContourShapePriorCollaborationDiagram}.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  center-&gt;SetInput(reader-&gt;GetOutput());</div>
<div class="line">  smoothing-&gt;SetInput(center-&gt;GetOutput());</div>
<div class="line">  gradientMagnitude-&gt;SetInput(smoothing-&gt;GetOutput());</div>
<div class="line">  reciprocal-&gt;SetInput(gradientMagnitude-&gt;GetOutput());</div>
<div class="line"> </div>
<div class="line">  geodesicActiveContour-&gt;SetInput(fastMarching-&gt;GetOutput());</div>
<div class="line">  geodesicActiveContour-&gt;SetFeatureImage(reciprocal-&gt;GetOutput());</div>
<div class="line"> </div>
<div class="line">  thresholder-&gt;SetInput(geodesicActiveContour-&gt;GetOutput());</div>
<div class="line">  writer-&gt;SetInput(thresholder-&gt;GetOutput());</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The CurvatureAnisotropicDiffusionImageFilter requires a couple of</span></div>
<div class="line">  <span class="comment">//  parameter to be defined. The following are typical values for $2D$</span></div>
<div class="line">  <span class="comment">//  images. However they may have to be adjusted depending on the amount of</span></div>
<div class="line">  <span class="comment">//  noise present in the input image. This filter has been discussed in</span></div>
<div class="line">  <span class="comment">//  section~\ref{sec:GradientAnisotropicDiffusionImageFilter}.</span></div>
<div class="line"> </div>
<div class="line">  smoothing-&gt;SetTimeStep(0.125);</div>
<div class="line">  smoothing-&gt;SetNumberOfIterations(5);</div>
<div class="line">  smoothing-&gt;SetConductanceParameter(9.0);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The GradientMagnitudeRecursiveGaussianImageFilter performs the</span></div>
<div class="line">  <span class="comment">//  equivalent of a convolution with a Gaussian kernel, followed by a</span></div>
<div class="line">  <span class="comment">//  derivative operator. The sigma of this Gaussian can be used to control</span></div>
<div class="line">  <span class="comment">//  the range of influence of the image edges. This filter has been</span></div>
<div class="line">  <span class="comment">//  discussed in</span></div>
<div class="line">  <span class="comment">//  Section~\ref{sec:GradientMagnitudeRecursiveGaussianImageFilter}.</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> sigma = std::stod(argv[10]);</div>
<div class="line">  gradientMagnitude-&gt;SetSigma(sigma);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The FastMarchingImageFilter requires the user to provide a seed</span></div>
<div class="line">  <span class="comment">//  point from which the level set will be generated. The user can actually</span></div>
<div class="line">  <span class="comment">//  pass not only one seed point but a set of them. Note that the</span></div>
<div class="line">  <span class="comment">//  FastMarchingImageFilter is used here only as a helper in the</span></div>
<div class="line">  <span class="comment">//  determination of an initial level set. We could have used the</span></div>
<div class="line">  <span class="comment">//  \doxygen{DanielssonDistanceMapImageFilter} in the same way.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The seeds are passed stored in a container. The type of this</span></div>
<div class="line">  <span class="comment">//  container is defined as \code{NodeContainer} among the</span></div>
<div class="line">  <span class="comment">//  FastMarchingImageFilter traits.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> NodeContainer = FastMarchingFilterType::NodeContainer;</div>
<div class="line">  <span class="keyword">using</span> NodeType = FastMarchingFilterType::NodeType;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> seeds = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">NodeContainer::New</a>();</div>
<div class="line"> </div>
<div class="line">  <a name="a20"></a><a class="code" href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#a246a71b35a903d08cb4d0aec86f6f366">InternalImageType::IndexType</a> seedPosition;</div>
<div class="line"> </div>
<div class="line">  seedPosition[0] = std::stoi(argv[3]);</div>
<div class="line">  seedPosition[1] = std::stoi(argv[4]);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Nodes are created as stack variables and initialized with a value and an</span></div>
<div class="line">  <span class="comment">//  \doxygen{Index} position. Note that here we assign the value of minus</span></div>
<div class="line">  <span class="comment">//  the user-provided distance to the unique node of the seeds passed to the</span></div>
<div class="line">  <span class="comment">//  FastMarchingImageFilter. In this way, the value will increment</span></div>
<div class="line">  <span class="comment">//  as the front is propagated, until it reaches the zero value</span></div>
<div class="line">  <span class="comment">//  corresponding to the contour. After this, the front will continue</span></div>
<div class="line">  <span class="comment">//  propagating until it fills up the entire image. The initial distance is</span></div>
<div class="line">  <span class="comment">//  taken here from the command line arguments. The rule of thumb for the</span></div>
<div class="line">  <span class="comment">//  user is to select this value as the distance from the seed points at</span></div>
<div class="line">  <span class="comment">//  which she want the initial contour to be.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> initialDistance = std::stod(argv[9]);</div>
<div class="line"> </div>
<div class="line">  NodeType node;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> seedValue = -initialDistance;</div>
<div class="line"> </div>
<div class="line">  node.SetValue(seedValue);</div>
<div class="line">  node.SetIndex(seedPosition);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The list of nodes is initialized and then every node is inserted using</span></div>
<div class="line">  <span class="comment">//  the \code{InsertElement()}.</span></div>
<div class="line"> </div>
<div class="line">  seeds-&gt;Initialize();</div>
<div class="line">  seeds-&gt;InsertElement(0, node);</div>
<div class="line"> </div>
<div class="line">  seedPosition[0] = std::stoi(argv[5]);</div>
<div class="line">  seedPosition[1] = std::stoi(argv[6]);</div>
<div class="line">  node.SetIndex(seedPosition);</div>
<div class="line">  seeds-&gt;InsertElement(1, node);</div>
<div class="line"> </div>
<div class="line">  seedPosition[0] = std::stoi(argv[7]);</div>
<div class="line">  seedPosition[1] = std::stoi(argv[8]);</div>
<div class="line">  node.SetIndex(seedPosition);</div>
<div class="line">  seeds-&gt;InsertElement(2, node);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The set of seed nodes is passed now to the</span></div>
<div class="line">  <span class="comment">//  FastMarchingImageFilter with the method</span></div>
<div class="line">  <span class="comment">//  \code{SetTrialPoints()}.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  fastMarching-&gt;SetTrialPoints(seeds);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Since the FastMarchingImageFilter is used here just as a</span></div>
<div class="line">  <span class="comment">//  Distance Map generator. It does not require a speed image as input.</span></div>
<div class="line">  <span class="comment">//  Instead the constant value $1.0$ is passed using the</span></div>
<div class="line">  <span class="comment">//  \code{SetSpeedConstant()} method.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  fastMarching-&gt;SetSpeedConstant(1.0);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Here we configure all the writers required to see the intermediate</span></div>
<div class="line">  <span class="comment">//  outputs of the pipeline. This is added here only for</span></div>
<div class="line">  <span class="comment">//  pedagogical/debugging purposes. These intermediate output are normaly</span></div>
<div class="line">  <span class="comment">//  not required. Only the output of the final thresholding filter should be</span></div>
<div class="line">  <span class="comment">//  relevant.  Observing intermediate output is helpful in the process of</span></div>
<div class="line">  <span class="comment">//  fine tuning the parameters of filters in the pipeline.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">auto</span> caster1 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">CastFilterType::New</a>();</div>
<div class="line">  <span class="keyword">auto</span> caster2 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">CastFilterType::New</a>();</div>
<div class="line">  <span class="keyword">auto</span> caster3 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">CastFilterType::New</a>();</div>
<div class="line">  <span class="keyword">auto</span> caster4 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">CastFilterType::New</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> writer1 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">WriterType::New</a>();</div>
<div class="line">  <span class="keyword">auto</span> writer2 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">WriterType::New</a>();</div>
<div class="line">  <span class="keyword">auto</span> writer3 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">WriterType::New</a>();</div>
<div class="line">  <span class="keyword">auto</span> writer4 = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">WriterType::New</a>();</div>
<div class="line"> </div>
<div class="line">  caster1-&gt;SetInput(smoothing-&gt;GetOutput());</div>
<div class="line">  writer1-&gt;SetInput(caster1-&gt;GetOutput());</div>
<div class="line">  writer1-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput1.png&quot;</span>);</div>
<div class="line">  caster1-&gt;SetOutputMinimum(0);</div>
<div class="line">  caster1-&gt;SetOutputMaximum(255);</div>
<div class="line">  writer1-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  caster2-&gt;SetInput(gradientMagnitude-&gt;GetOutput());</div>
<div class="line">  writer2-&gt;SetInput(caster2-&gt;GetOutput());</div>
<div class="line">  writer2-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput2.png&quot;</span>);</div>
<div class="line">  caster2-&gt;SetOutputMinimum(0);</div>
<div class="line">  caster2-&gt;SetOutputMaximum(255);</div>
<div class="line">  writer2-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  caster3-&gt;SetInput(reciprocal-&gt;GetOutput());</div>
<div class="line">  writer3-&gt;SetInput(caster3-&gt;GetOutput());</div>
<div class="line">  writer3-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput3.png&quot;</span>);</div>
<div class="line">  caster3-&gt;SetOutputMinimum(0);</div>
<div class="line">  caster3-&gt;SetOutputMaximum(255);</div>
<div class="line">  writer3-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  caster4-&gt;SetInput(fastMarching-&gt;GetOutput());</div>
<div class="line">  writer4-&gt;SetInput(caster4-&gt;GetOutput());</div>
<div class="line">  writer4-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput4.png&quot;</span>);</div>
<div class="line">  caster4-&gt;SetOutputMinimum(0);</div>
<div class="line">  caster4-&gt;SetOutputMaximum(255);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  The FastMarchingImageFilter requires the user to specify the</span></div>
<div class="line">  <span class="comment">//  size of the image to be produced as output. This is done using the</span></div>
<div class="line">  <span class="comment">//  \code{SetOutputRegion()}. Note that the size is obtained here from the</span></div>
<div class="line">  <span class="comment">//  output image of the centering filter. The size of this image is valid</span></div>
<div class="line">  <span class="comment">//  only after the \code{Update()} methods of this filter has been called</span></div>
<div class="line">  <span class="comment">//  directly or indirectly.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  fastMarching-&gt;SetOutputRegion(center-&gt;GetOutput()-&gt;GetBufferedRegion());</div>
<div class="line">  fastMarching-&gt;SetOutputSpacing(center-&gt;GetOutput()-&gt;GetSpacing());</div>
<div class="line">  fastMarching-&gt;SetOutputOrigin(center-&gt;GetOutput()-&gt;GetOrigin());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Next, we define the shape model. In this example,</span></div>
<div class="line">  <span class="comment">//  we use an implicit shape model based on the principal components</span></div>
<div class="line">  <span class="comment">//  such that:</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \begin{equation}</span></div>
<div class="line">  <span class="comment">//  \psi^{*}(\mathbf{x}) = \mu(\mathbf{x}) + \sum_k \alpha_k u_k(\mathbf{x})</span></div>
<div class="line">  <span class="comment">//  \end{equation}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  where $\mu(\mathbf{x})$ is the mean signed distance computed from</span></div>
<div class="line">  <span class="comment">//  training set of segmented objects and $u_k(\mathbf{x})$ are the first</span></div>
<div class="line">  <span class="comment">//  $K$ principal components of the offset (signed distance - mean). The</span></div>
<div class="line">  <span class="comment">//  coefficients $\{\alpha_k\}$ form the set of \emph{shape} parameters.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Given a set of training data, the \doxygen{ImagePCAShapeModelEstimator}</span></div>
<div class="line">  <span class="comment">//  can be used to obtain</span></div>
<div class="line">  <span class="comment">//  the mean and principal mode shape images required by</span></div>
<div class="line">  <span class="comment">//  PCAShapeSignedDistanceFunction.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::PCAShapeSignedDistanceFunction!New()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::PCAShapeSignedDistanceFunction!SetNumberOfPrincipalComponents()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numberOfPCAModes = std::stoi(argv[14]);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> ShapeFunctionType =</div>
<div class="line">    <a name="_a21"></a><a class="code" href="classitk_1_1PCAShapeSignedDistanceFunction.html">itk::PCAShapeSignedDistanceFunction&lt;double, Dimension, InternalImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> shape = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">ShapeFunctionType::New</a>();</div>
<div class="line"> </div>
<div class="line">  shape-&gt;SetNumberOfPrincipalComponents(numberOfPCAModes);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  In this example, we will read the mean shape and</span></div>
<div class="line">  <span class="comment">//  principal mode images from file. We will assume that</span></div>
<div class="line">  <span class="comment">//  the filenames of the mode images form a numeric series starting from</span></div>
<div class="line">  <span class="comment">//  index 0.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::PCAShapeSignedDistanceFunction!SetMeanImage()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::PCAShapeSignedDistanceFunction!SetPrincipalComponentsImages()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">auto</span> meanShapeReader = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">ReaderType::New</a>();</div>
<div class="line">  meanShapeReader-&gt;SetFileName(argv[13]);</div>
<div class="line">  meanShapeReader-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;InternalImageType::Pointer&gt; shapeModeImages(numberOfPCAModes);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> fileNamesCreator = <a name="a22"></a><a class="code" href="classitk_1_1NumericSeriesFileNames.html#a5155882e4b775cac5646a24a332af623">itk::NumericSeriesFileNames::New</a>();</div>
<div class="line"> </div>
<div class="line">  fileNamesCreator-&gt;SetStartIndex(0);</div>
<div class="line">  fileNamesCreator-&gt;SetEndIndex(numberOfPCAModes - 1);</div>
<div class="line">  fileNamesCreator-&gt;SetSeriesFormat(argv[15]);</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;std::string&gt; &amp; shapeModeFileNames =</div>
<div class="line">    fileNamesCreator-&gt;GetFileNames();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; numberOfPCAModes; ++k)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">auto</span> shapeModeReader = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">ReaderType::New</a>();</div>
<div class="line">    shapeModeReader-&gt;SetFileName(shapeModeFileNames[k].c_str());</div>
<div class="line">    shapeModeReader-&gt;Update();</div>
<div class="line">    shapeModeImages[k] = shapeModeReader-&gt;GetOutput();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  shape-&gt;SetMeanImage(meanShapeReader-&gt;GetOutput());</div>
<div class="line">  shape-&gt;SetPrincipalComponentImages(shapeModeImages);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Further we assume that the shape modes have been normalized</span></div>
<div class="line">  <span class="comment">// by multiplying with the corresponding singular value. Hence,</span></div>
<div class="line">  <span class="comment">// we can set the principal component standard deviations to all</span></div>
<div class="line">  <span class="comment">// ones.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::PCAShapeSignedDistanceFunction!Set\-Principal\-Component\-Standard\-Deviations()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  ShapeFunctionType::ParametersType pcaStandardDeviations(numberOfPCAModes);</div>
<div class="line">  pcaStandardDeviations.Fill(1.0);</div>
<div class="line"> </div>
<div class="line">  shape-&gt;SetPrincipalComponentStandardDeviations(pcaStandardDeviations);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Next, we instantiate a \doxygen{Euler2DTransform} and connect it to the</span></div>
<div class="line">  <span class="comment">// PCASignedDistanceFunction. The transform represent</span></div>
<div class="line">  <span class="comment">// the pose of the shape. The parameters of the transform</span></div>
<div class="line">  <span class="comment">// forms the set of \emph{pose} parameters.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::PCAShapeSignedDistanceFunction!SetTransform()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::ShapeSignedDistanceFunction!SetTransform()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> TransformType = <a name="_a23"></a><a class="code" href="classitk_1_1Euler2DTransform.html">itk::Euler2DTransform&lt;double&gt;</a>;</div>
<div class="line">  <span class="keyword">auto</span> transform = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">TransformType::New</a>();</div>
<div class="line"> </div>
<div class="line">  shape-&gt;SetTransform(transform);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Before updating the level set at each iteration, the parameters</span></div>
<div class="line">  <span class="comment">// of the current best-fit shape is estimated by minimizing the</span></div>
<div class="line">  <span class="comment">// \doxygen{ShapePriorMAPCostFunction}. The cost function is composed of</span></div>
<div class="line">  <span class="comment">// four terms: contour fit, image fit, shape prior and pose prior.</span></div>
<div class="line">  <span class="comment">// The user can specify the weights applied to each term.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::ShapePriorMAPCostFunction!SetWeights()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> CostFunctionType =</div>
<div class="line">    <a name="_a24"></a><a class="code" href="classitk_1_1ShapePriorMAPCostFunction.html">itk::ShapePriorMAPCostFunction&lt;InternalImageType, InternalPixelType&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> costFunction = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">CostFunctionType::New</a>();</div>
<div class="line"> </div>
<div class="line">  CostFunctionType::WeightsType weights;</div>
<div class="line">  weights[0] = 1.0;  <span class="comment">// weight for contour fit term</span></div>
<div class="line">  weights[1] = 20.0; <span class="comment">// weight for image fit term</span></div>
<div class="line">  weights[2] = 1.0;  <span class="comment">// weight for shape prior term</span></div>
<div class="line">  weights[3] = 1.0;  <span class="comment">// weight for pose prior term</span></div>
<div class="line"> </div>
<div class="line">  costFunction-&gt;SetWeights(weights);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Contour fit measures the likelihood of seeing the current</span></div>
<div class="line">  <span class="comment">// evolving contour for a given set of shape/pose parameters.</span></div>
<div class="line">  <span class="comment">// This is computed by counting the number of pixels inside</span></div>
<div class="line">  <span class="comment">// the current contour but outside the current shape.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Image fit measures the likelihood of seeing certain image</span></div>
<div class="line">  <span class="comment">// features for a given set of shape/pose parameters. This is</span></div>
<div class="line">  <span class="comment">// computed by assuming that ( 1 - edge potential ) approximates</span></div>
<div class="line">  <span class="comment">// a zero-mean, unit variance Gaussian along the normal of</span></div>
<div class="line">  <span class="comment">// the evolving contour. Image fit is then computed by computing</span></div>
<div class="line">  <span class="comment">// the Laplacian goodness of fit of the Gaussian:</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// \begin{equation}</span></div>
<div class="line">  <span class="comment">// \sum \left( G(\psi(\mathbf{x})) - |1 - g(\mathbf{x})| \right)^2</span></div>
<div class="line">  <span class="comment">// \end{equation}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// where $G$ is a zero-mean, unit variance Gaussian and $g$ is</span></div>
<div class="line">  <span class="comment">// the edge potential feature image.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// The pose parameters are assumed to have a uniform distribution</span></div>
<div class="line">  <span class="comment">// and hence do not contribute to the cost function.</span></div>
<div class="line">  <span class="comment">// The shape parameters are assumed to have a Gaussian distribution.</span></div>
<div class="line">  <span class="comment">// The parameters of the distribution are user-specified. Since we</span></div>
<div class="line">  <span class="comment">// assumed the principal modes have already been normalized,</span></div>
<div class="line">  <span class="comment">// we set the distribution to zero mean and unit variance.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::ShapePriorMAPCostFunction!SetShapeParameterMeans()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::ShapePriorMAPCostFunction!SetShapeParameterStandardDeviations()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  CostFunctionType::ArrayType mean(shape-&gt;GetNumberOfShapeParameters());</div>
<div class="line">  CostFunctionType::ArrayType stddev(shape-&gt;GetNumberOfShapeParameters());</div>
<div class="line"> </div>
<div class="line">  mean.Fill(0.0);</div>
<div class="line">  stddev.Fill(1.0);</div>
<div class="line">  costFunction-&gt;SetShapeParameterMeans(mean);</div>
<div class="line">  costFunction-&gt;SetShapeParameterStandardDeviations(stddev);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// In this example, we will use the</span></div>
<div class="line">  <span class="comment">// \doxygen{OnePlusOneEvolutionaryOptimizer} to optimize the cost function.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> OptimizerType = <a name="_a25"></a><a class="code" href="classitk_1_1OnePlusOneEvolutionaryOptimizer.html">itk::OnePlusOneEvolutionaryOptimizer</a>;</div>
<div class="line">  <span class="keyword">auto</span> optimizer = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">OptimizerType::New</a>();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// The evolutionary optimization algorithm is based on testing</span></div>
<div class="line">  <span class="comment">// random permutations of the parameters. As such, we need to provide</span></div>
<div class="line">  <span class="comment">// the optimizer with a random number generator. In the following lines,</span></div>
<div class="line">  <span class="comment">// we create a \doxygen{NormalVariateGenerator}, seed it, and</span></div>
<div class="line">  <span class="comment">// connect it to the optimizer.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Statistics::NormalVariateGenerator!Initialize()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::OnePlusOneEvolutionaryOptimizer!SetNormalVariateGenerator()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> GeneratorType = <a name="_a26"></a><a class="code" href="classitk_1_1Statistics_1_1NormalVariateGenerator.html">itk::Statistics::NormalVariateGenerator</a>;</div>
<div class="line">  <span class="keyword">auto</span> generator = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">GeneratorType::New</a>();</div>
<div class="line"> </div>
<div class="line">  generator-&gt;Initialize(20020702);</div>
<div class="line"> </div>
<div class="line">  optimizer-&gt;SetNormalVariateGenerator(generator);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// The cost function has $K+3$ parameters. The first $K$</span></div>
<div class="line">  <span class="comment">// parameters are the principal component multipliers, followed</span></div>
<div class="line">  <span class="comment">// by the 2D rotation parameter (in radians) and the x- and</span></div>
<div class="line">  <span class="comment">// y- translation parameters (in mm).  We need to carefully</span></div>
<div class="line">  <span class="comment">// scale the different types of parameters to compensate</span></div>
<div class="line">  <span class="comment">// for the differences in the dynamic ranges of the parameters.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::OnePlusOneEvolutionaryOptimizer!SetScales()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  OptimizerType::ScalesType scales(shape-&gt;GetNumberOfParameters());</div>
<div class="line">  scales.Fill(1.0);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; numberOfPCAModes; ++k)</div>
<div class="line">  {</div>
<div class="line">    scales[k] = 20.0; <span class="comment">// scales for the pca mode multiplier</span></div>
<div class="line">  }</div>
<div class="line">  scales[numberOfPCAModes] = 350.0; <span class="comment">// scale for 2D rotation</span></div>
<div class="line">  optimizer-&gt;SetScales(scales);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Next, we specify the initial radius, the shrink and</span></div>
<div class="line">  <span class="comment">// grow mutation factors and termination criteria of the optimizer.</span></div>
<div class="line">  <span class="comment">// Since the best-fit shape is re-estimated each iteration of</span></div>
<div class="line">  <span class="comment">// the curve evolution, we do not need to spend too much time finding the</span></div>
<div class="line">  <span class="comment">// true minimizing solution each time; we only need to head towards it. As</span></div>
<div class="line">  <span class="comment">// such, we only require a small number of optimizer iterations.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::OnePlusOneEvolutionaryOptimizer!Initialize()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::OnePlusOneEvolutionaryOptimizer!SetEpsilon()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::OnePlusOneEvolutionaryOptimizer!SetMaximumIteration()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keywordtype">double</span> initRadius = 1.05;</div>
<div class="line">  <span class="keywordtype">double</span> grow = 1.1;</div>
<div class="line">  <span class="keywordtype">double</span> shrink = pow(grow, -0.25);</div>
<div class="line">  optimizer-&gt;Initialize(initRadius, grow, shrink);</div>
<div class="line"> </div>
<div class="line">  optimizer-&gt;SetEpsilon(1.0<a name="a27"></a><a class="code" href="namespaceitk_1_1Math.html#af105436026645171db6a4a3000ee8482">e</a>-6); <span class="comment">// minimal search radius</span></div>
<div class="line"> </div>
<div class="line">  optimizer-&gt;SetMaximumIteration(15);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Before starting the segmentation process we need to also supply the</span></div>
<div class="line">  <span class="comment">// initial best-fit shape estimate. In this example, we start with the</span></div>
<div class="line">  <span class="comment">// unrotated mean shape with the initial x- and y- translation specified</span></div>
<div class="line">  <span class="comment">// through command-line arguments.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  ShapeFunctionType::ParametersType parameters(</div>
<div class="line">    shape-&gt;GetNumberOfParameters());</div>
<div class="line">  parameters.Fill(0.0);</div>
<div class="line">  parameters[numberOfPCAModes + 1] = std::stod(argv[16]); <span class="comment">// startX</span></div>
<div class="line">  parameters[numberOfPCAModes + 2] = std::stod(argv[17]); <span class="comment">// startY</span></div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Finally, we connect all the components to the filter and add our</span></div>
<div class="line">  <span class="comment">// observer.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  geodesicActiveContour-&gt;SetShapeFunction(shape);</div>
<div class="line">  geodesicActiveContour-&gt;SetCostFunction(costFunction);</div>
<div class="line">  geodesicActiveContour-&gt;SetOptimizer(optimizer);</div>
<div class="line">  geodesicActiveContour-&gt;SetInitialParameters(parameters);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> CommandType = CommandIterationUpdate&lt;GeodesicActiveContourFilterType&gt;;</div>
<div class="line">  <span class="keyword">auto</span> observer = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">CommandType::New</a>();</div>
<div class="line">  geodesicActiveContour-&gt;AddObserver(itk::IterationEvent(), observer);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The invocation of the \code{Update()} method on the writer triggers the</span></div>
<div class="line">  <span class="comment">//  execution of the pipeline.  As usual, the call is placed in a</span></div>
<div class="line">  <span class="comment">//  \code{try/catch} block to handle exceptions should errors occur.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">  {</div>
<div class="line">    writer-&gt;Update();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<span class="keyword">const</span> itk::ExceptionObject &amp; excep)</div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception caught !&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cerr &lt;&lt; excep &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Print out some useful information</span></div>
<div class="line">  std::cout &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Max. no. iterations: &quot;</span></div>
<div class="line">            &lt;&lt; geodesicActiveContour-&gt;GetNumberOfIterations() &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Max. RMS error: &quot;</span></div>
<div class="line">            &lt;&lt; geodesicActiveContour-&gt;GetMaximumRMSError() &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;No. elpased iterations: &quot;</span></div>
<div class="line">            &lt;&lt; geodesicActiveContour-&gt;GetElapsedIterations() &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;RMS change: &quot;</span> &lt;&lt; geodesicActiveContour-&gt;GetRMSChange()</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Parameters: &quot;</span> &lt;&lt; geodesicActiveContour-&gt;GetCurrentParameters()</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  writer4-&gt;Update();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// The following writer type is used to save the output of the time-crossing</span></div>
<div class="line">  <span class="comment">// map in a file with apropiate pixel representation. The advantage of</span></div>
<div class="line">  <span class="comment">// saving this image in native format is that it can be used with a viewer</span></div>
<div class="line">  <span class="comment">// to help determine an appropriate threshold to be used on the output of</span></div>
<div class="line">  <span class="comment">// the fastmarching filter.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="keyword">using</span> InternalWriterType = <a class="code" href="classitk_1_1ImageFileWriter.html">itk::ImageFileWriter&lt;InternalImageType&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> mapWriter = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">InternalWriterType::New</a>();</div>
<div class="line">  mapWriter-&gt;SetInput(fastMarching-&gt;GetOutput());</div>
<div class="line">  mapWriter-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput4.mha&quot;</span>);</div>
<div class="line">  mapWriter-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> speedWriter = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">InternalWriterType::New</a>();</div>
<div class="line">  speedWriter-&gt;SetInput(reciprocal-&gt;GetOutput());</div>
<div class="line">  speedWriter-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput3.mha&quot;</span>);</div>
<div class="line">  speedWriter-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> gradientWriter = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">InternalWriterType::New</a>();</div>
<div class="line">  gradientWriter-&gt;SetInput(gradientMagnitude-&gt;GetOutput());</div>
<div class="line">  gradientWriter-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput2.mha&quot;</span>);</div>
<div class="line">  gradientWriter-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Also write out the initial and final best fit shape</span></div>
<div class="line">  <span class="keyword">using</span> EvaluatorFilterType =</div>
<div class="line">    <a name="_a28"></a><a class="code" href="classitk_1_1SpatialFunctionImageEvaluatorFilter.html">itk::SpatialFunctionImageEvaluatorFilter</a>&lt;ShapeFunctionType,</div>
<div class="line">                                             InternalImageType,</div>
<div class="line">                                             InternalImageType&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> evaluator = <a class="code" href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">EvaluatorFilterType::New</a>();</div>
<div class="line">  evaluator-&gt;SetInput(geodesicActiveContour-&gt;GetOutput());</div>
<div class="line">  evaluator-&gt;SetFunction(shape);</div>
<div class="line">  shape-&gt;SetParameters(geodesicActiveContour-&gt;GetInitialParameters());</div>
<div class="line"> </div>
<div class="line">  thresholder-&gt;SetInput(evaluator-&gt;GetOutput());</div>
<div class="line">  writer-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput5.png&quot;</span>);</div>
<div class="line">  writer-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  shape-&gt;SetParameters(geodesicActiveContour-&gt;GetCurrentParameters());</div>
<div class="line">  evaluator-&gt;Modified();</div>
<div class="line">  writer-&gt;SetFileName(</div>
<div class="line">    <span class="stringliteral">&quot;GeodesicActiveContourShapePriorImageFilterOutput6.png&quot;</span>);</div>
<div class="line">  writer-&gt;Update();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Deviating from previous examples, we will demonstrate this example using</span></div>
<div class="line">  <span class="comment">//  \code{BrainMidSagittalSlice.png}</span></div>
<div class="line">  <span class="comment">//  (Figure~\ref{fig:GeodesicActiveContourShapePriorImageFilterOutput},</span></div>
<div class="line">  <span class="comment">//  left) from the \code{Examples/Data} directory. The aim here is to</span></div>
<div class="line">  <span class="comment">//  segment the corpus callosum from the image using a shape model defined</span></div>
<div class="line">  <span class="comment">//  by \code{CorpusCallosumMeanShape.mha} and the first three principal</span></div>
<div class="line">  <span class="comment">//  components \code{CorpusCallosumMode0.mha},</span></div>
<div class="line">  <span class="comment">//  \code{CorpusCallosumMode1.mha} and \code{CorpusCallosumMode12.mha}. As</span></div>
<div class="line">  <span class="comment">//  shown in Figure~\ref{fig:CorpusCallosumPCAModes}, the first mode</span></div>
<div class="line">  <span class="comment">//  captures scaling, the second mode captures the shifting of mass between</span></div>
<div class="line">  <span class="comment">//  the rostrum and the splenium and the third mode captures the degree of</span></div>
<div class="line">  <span class="comment">//  curvature. Segmentation results with and without shape guidance are</span></div>
<div class="line">  <span class="comment">//  shown in</span></div>
<div class="line">  <span class="comment">//  Figure~\ref{fig:GeodesicActiveContourShapePriorImageFilterOutput2}.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \begin{figure} \center</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.30\textwidth]{BrainMidSagittalSlice}</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.30\textwidth]{GeodesicActiveContourShapePriorImageFilterOutput5}</span></div>
<div class="line">  <span class="comment">//  \itkcaption[GeodesicActiveContourShapePriorImageFilter input image and</span></div>
<div class="line">  <span class="comment">//  initial model]{ The input image to the</span></div>
<div class="line">  <span class="comment">//  GeodesicActiveContourShapePriorLevelSetImageFilter is a synthesized</span></div>
<div class="line">  <span class="comment">//  MR-T1 mid-sagittal slice ($217 \times 180$ pixels, $1 \times 1$ mm</span></div>
<div class="line">  <span class="comment">//  spacing) of the brain (left) and the initial best-fit shape (right)</span></div>
<div class="line">  <span class="comment">//  chosen to roughly overlap the corpus callosum in the image to be</span></div>
<div class="line">  <span class="comment">//  segmented.}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \label{fig:GeodesicActiveContourShapePriorImageFilterOutput}</span></div>
<div class="line">  <span class="comment">//  \end{figure}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \begin{figure}</span></div>
<div class="line">  <span class="comment">//  \center</span></div>
<div class="line">  <span class="comment">//  \begin{tabular}{cccc}</span></div>
<div class="line">  <span class="comment">//  &amp; $-3\sigma$ &amp; mean &amp; $+3\sigma$ \\ mode 0: &amp;</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.10\textwidth]{CorpusCallosumModeMinus0} &amp;</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.10\textwidth]{CorpusCallosumMeanShape} &amp;</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.10\textwidth]{CorpusCallosumModePlus0} \\ mode</span></div>
<div class="line">  <span class="comment">//  1: &amp; \includegraphics[width=0.10\textwidth]{CorpusCallosumModeMinus1} &amp;</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.10\textwidth]{CorpusCallosumMeanShape} &amp;</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.10\textwidth]{CorpusCallosumModePlus1} \\ mode</span></div>
<div class="line">  <span class="comment">//  2: &amp; \includegraphics[width=0.10\textwidth]{CorpusCallosumModeMinus2} &amp;</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.10\textwidth]{CorpusCallosumMeanShape} &amp;</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.10\textwidth]{CorpusCallosumModePlus2}</span></div>
<div class="line">  <span class="comment">//  \\ \end{tabular}</span></div>
<div class="line">  <span class="comment">//  \itkcaption[Corpus callosum PCA modes]{First three PCA</span></div>
<div class="line">  <span class="comment">//  modes of a low-resolution</span></div>
<div class="line">  <span class="comment">//  ($58 \times 31$ pixels, $2 \times 2$ mm spacing) corpus callosum model</span></div>
<div class="line">  <span class="comment">//  used in the shape guided geodesic active contours example.}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \label{fig:CorpusCallosumPCAModes}</span></div>
<div class="line">  <span class="comment">//  \end{figure}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  A sigma value of $1.0$ was used to compute the image gradient and the</span></div>
<div class="line">  <span class="comment">//  propagation and shape prior scaling are respectively set to $0.5$ and</span></div>
<div class="line">  <span class="comment">//  $0.02$. An initial level set was created by placing one seed point in</span></div>
<div class="line">  <span class="comment">//  the rostrum $(60,102)$, one in the splenium $(120, 85)$ and one</span></div>
<div class="line">  <span class="comment">//  centrally in the body $(88,83)$ of the corpus callosum with</span></div>
<div class="line">  <span class="comment">//  an initial radius of $6$ pixels at each seed position.</span></div>
<div class="line">  <span class="comment">//  The best-fit shape was initially placed with a translation of</span></div>
<div class="line">  <span class="comment">//  $(10,0)$mm so that it roughly overlapped</span></div>
<div class="line">  <span class="comment">//  the corpus callosum in the image as shown in</span></div>
<div class="line">  <span class="comment">//  Figure~\ref{fig:GeodesicActiveContourShapePriorImageFilterOutput}</span></div>
<div class="line">  <span class="comment">//  (right).</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  From Figure~\ref{fig:GeodesicActiveContourShapePriorImageFilterOutput2}</span></div>
<div class="line">  <span class="comment">//  it can be observed that without shape guidance (left), segmentation</span></div>
<div class="line">  <span class="comment">//  using geodesic active contour leaks in the regions where the corpus</span></div>
<div class="line">  <span class="comment">//  callosum blends into the surrounding brain tissues. With shape guidance</span></div>
<div class="line">  <span class="comment">//  (center), the segmentation is constrained by the global shape model to</span></div>
<div class="line">  <span class="comment">//  prevent leaking.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The final best-fit shape parameters after the segmentation process is:</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \begin{verbatim}</span></div>
<div class="line">  <span class="comment">//  Parameters: [-0.384988, -0.578738, 0.557793, 0.275202, 16.9992, 4.73473]</span></div>
<div class="line">  <span class="comment">//  \end{verbatim}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  and is shown in</span></div>
<div class="line">  <span class="comment">//  Figure~\ref{fig:GeodesicActiveContourShapePriorImageFilterOutput2}</span></div>
<div class="line">  <span class="comment">//  (right). Note that a $0.28$ radian ($15.8$ degree) rotation has been</span></div>
<div class="line">  <span class="comment">//  introduced to match the model to the corpus callosum in the image.</span></div>
<div class="line">  <span class="comment">//  Additionally, a negative weight for the first mode shrinks the size</span></div>
<div class="line">  <span class="comment">//  relative to the mean shape. A negative weight for the second mode shifts</span></div>
<div class="line">  <span class="comment">//  the mass to splenium, and a positive weight for the third mode increases</span></div>
<div class="line">  <span class="comment">//  the curvature. It can also be observed that the final segmentation is a</span></div>
<div class="line">  <span class="comment">//  combination of the best-fit shape with additional local deformation. The</span></div>
<div class="line">  <span class="comment">//  combination of both global and local shape allows the segmentation to</span></div>
<div class="line">  <span class="comment">//  capture fine details not represented in the shape model.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \begin{figure} \center</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.30\textwidth]{GeodesicActiveContourShapePriorImageFilterOutput1}</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.30\textwidth]{GeodesicActiveContourShapePriorImageFilterOutput2}</span></div>
<div class="line">  <span class="comment">//  \includegraphics[width=0.30\textwidth]{GeodesicActiveContourShapePriorImageFilterOutput6}</span></div>
<div class="line">  <span class="comment">//  \itkcaption[GeodesicActiveContourShapePriorImageFilter</span></div>
<div class="line">  <span class="comment">//  segmentations]{Corpus callosum segmentation using geodesic active</span></div>
<div class="line">  <span class="comment">//  contours without (left) and with (center) shape guidance. The image on</span></div>
<div class="line">  <span class="comment">//  the right represents the best-fit shape at the end of the segmentation</span></div>
<div class="line">  <span class="comment">//  process.}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \label{fig:GeodesicActiveContourShapePriorImageFilterOutput2}</span></div>
<div class="line">  <span class="comment">//  \end{figure}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="aitkAddImageFilter_8h_html_ac831674d6d3f7cd2148ae944cbaa7c9d"><div class="ttname"><a href="itkAddImageFilter_8h.html#ac831674d6d3f7cd2148ae944cbaa7c9d">Pointer</a></div><div class="ttdeci">SmartPointer&lt; Self &gt; Pointer</div><div class="ttdef"><b>Definition:</b> <a href="itkAddImageFilter_8h_source.html#l00092">itkAddImageFilter.h:92</a></div></div>
<div class="ttc" id="aitkSpatialFunctionImageEvaluatorFilter_8h_html"><div class="ttname"><a href="itkSpatialFunctionImageEvaluatorFilter_8h.html">itkSpatialFunctionImageEvaluatorFilter.h</a></div></div>
<div class="ttc" id="aitkEuler2DTransform_8h_html"><div class="ttname"><a href="itkEuler2DTransform_8h.html">itkEuler2DTransform.h</a></div></div>
<div class="ttc" id="aclassitk_1_1PCAShapeSignedDistanceFunction_html"><div class="ttname"><a href="classitk_1_1PCAShapeSignedDistanceFunction.html">itk::PCAShapeSignedDistanceFunction</a></div><div class="ttdoc">Compute the signed distance from a N-dimensional PCA Shape.</div><div class="ttdef"><b>Definition:</b> <a href="itkPCAShapeSignedDistanceFunction_8h_source.html#l00067">itkPCAShapeSignedDistanceFunction.h:67</a></div></div>
<div class="ttc" id="aclassitk_1_1BinaryThresholdImageFilter_html"><div class="ttname"><a href="classitk_1_1BinaryThresholdImageFilter.html">itk::BinaryThresholdImageFilter</a></div><div class="ttdoc">Binarize an input image by thresholding.</div><div class="ttdef"><b>Definition:</b> <a href="itkBinaryThresholdImageFilter_8h_source.html#l00132">itkBinaryThresholdImageFilter.h:132</a></div></div>
<div class="ttc" id="aclassitk_1_1ShapePriorMAPCostFunction_html"><div class="ttname"><a href="classitk_1_1ShapePriorMAPCostFunction.html">itk::ShapePriorMAPCostFunction</a></div><div class="ttdoc">Represents the maximum aprior (MAP) cost function used ShapePriorSegmentationLevelSetImageFilter to e...</div><div class="ttdef"><b>Definition:</b> <a href="itkShapePriorMAPCostFunction_8h_source.html#l00050">itkShapePriorMAPCostFunction.h:50</a></div></div>
<div class="ttc" id="aitkImageFileReader_8h_html"><div class="ttname"><a href="itkImageFileReader_8h.html">itkImageFileReader.h</a></div></div>
<div class="ttc" id="aclassitk_1_1SmartPointer_html"><div class="ttname"><a href="classitk_1_1SmartPointer.html">itk::SmartPointer&lt; Self &gt;</a></div></div>
<div class="ttc" id="aclassitk_1_1ChangeInformationImageFilter_html"><div class="ttname"><a href="classitk_1_1ChangeInformationImageFilter.html">itk::ChangeInformationImageFilter</a></div><div class="ttdoc">Change the origin, spacing and/or region of an Image.</div><div class="ttdef"><b>Definition:</b> <a href="itkChangeInformationImageFilter_8h_source.html#l00049">itkChangeInformationImageFilter.h:49</a></div></div>
<div class="ttc" id="aclassitk_1_1BoundedReciprocalImageFilter_html"><div class="ttname"><a href="classitk_1_1BoundedReciprocalImageFilter.html">itk::BoundedReciprocalImageFilter</a></div><div class="ttdoc">Computes 1/(1+x) for each pixel in the image.</div><div class="ttdef"><b>Definition:</b> <a href="itkBoundedReciprocalImageFilter_8h_source.html#l00069">itkBoundedReciprocalImageFilter.h:69</a></div></div>
<div class="ttc" id="aitkFastMarchingImageFilter_8h_html"><div class="ttname"><a href="itkFastMarchingImageFilter_8h.html">itkFastMarchingImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1ImageFileReader_html"><div class="ttname"><a href="classitk_1_1ImageFileReader.html">itk::ImageFileReader</a></div><div class="ttdoc">Data source that reads image data from a single file.</div><div class="ttdef"><b>Definition:</b> <a href="itkImageFileReader_8h_source.html#l00075">itkImageFileReader.h:75</a></div></div>
<div class="ttc" id="anamespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2_html_a246a71b35a903d08cb4d0aec86f6f366"><div class="ttname"><a href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#a246a71b35a903d08cb4d0aec86f6f366">itk::GTest::TypedefsAndConstructors::Dimension2::IndexType</a></div><div class="ttdeci">ImageBaseType::IndexType IndexType</div><div class="ttdef"><b>Definition:</b> <a href="itkGTestTypedefsAndConstructors_8h_source.html#l00050">itkGTestTypedefsAndConstructors.h:50</a></div></div>
<div class="ttc" id="aclassitk_1_1Command_html"><div class="ttname"><a href="classitk_1_1Command.html">itk::Command</a></div><div class="ttdoc">Superclass for callback/observer methods.</div><div class="ttdef"><b>Definition:</b> <a href="itkCommand_8h_source.html#l00045">itkCommand.h:45</a></div></div>
<div class="ttc" id="aclassitk_1_1CurvatureAnisotropicDiffusionImageFilter_html"><div class="ttname"><a href="classitk_1_1CurvatureAnisotropicDiffusionImageFilter.html">itk::CurvatureAnisotropicDiffusionImageFilter</a></div><div class="ttdoc">This filter performs anisotropic diffusion on a scalar itk::Image using the modified curvature diffus...</div><div class="ttdef"><b>Definition:</b> <a href="itkCurvatureAnisotropicDiffusionImageFilter_8h_source.html#l00058">itkCurvatureAnisotropicDiffusionImageFilter.h:58</a></div></div>
<div class="ttc" id="aclassitk_1_1Statistics_1_1NormalVariateGenerator_html"><div class="ttname"><a href="classitk_1_1Statistics_1_1NormalVariateGenerator.html">itk::Statistics::NormalVariateGenerator</a></div><div class="ttdoc">Normal random variate generator.</div><div class="ttdef"><b>Definition:</b> <a href="itkNormalVariateGenerator_8h_source.html#l00098">itkNormalVariateGenerator.h:98</a></div></div>
<div class="ttc" id="aitkNumericSeriesFileNames_8h_html"><div class="ttname"><a href="itkNumericSeriesFileNames_8h.html">itkNumericSeriesFileNames.h</a></div></div>
<div class="ttc" id="aitkCurvatureAnisotropicDiffusionImageFilter_8h_html"><div class="ttname"><a href="itkCurvatureAnisotropicDiffusionImageFilter_8h.html">itkCurvatureAnisotropicDiffusionImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1SpatialFunctionImageEvaluatorFilter_html"><div class="ttname"><a href="classitk_1_1SpatialFunctionImageEvaluatorFilter.html">itk::SpatialFunctionImageEvaluatorFilter</a></div><div class="ttdoc">Evaluates a SpatialFunction onto a source image.</div><div class="ttdef"><b>Definition:</b> <a href="itkSpatialFunctionImageEvaluatorFilter_8h_source.html#l00043">itkSpatialFunctionImageEvaluatorFilter.h:43</a></div></div>
<div class="ttc" id="aclassitk_1_1ImageFileWriter_html"><div class="ttname"><a href="classitk_1_1ImageFileWriter.html">itk::ImageFileWriter</a></div><div class="ttdoc">Writes image data to a single file.</div><div class="ttdef"><b>Definition:</b> <a href="itkImageFileWriter_8h_source.html#l00088">itkImageFileWriter.h:88</a></div></div>
<div class="ttc" id="aitkBoundedReciprocalImageFilter_8h_html"><div class="ttname"><a href="itkBoundedReciprocalImageFilter_8h.html">itkBoundedReciprocalImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1FastMarchingImageFilter_html"><div class="ttname"><a href="classitk_1_1FastMarchingImageFilter.html">itk::FastMarchingImageFilter</a></div><div class="ttdoc">Solve an Eikonal equation using Fast Marching.</div><div class="ttdef"><b>Definition:</b> <a href="itkFastMarchingImageFilter_8h_source.html#l00136">itkFastMarchingImageFilter.h:136</a></div></div>
<div class="ttc" id="anamespaceitk_html_af2b97d337bf8035236a54a91fdcf040a"><div class="ttname"><a href="namespaceitk.html#af2b97d337bf8035236a54a91fdcf040a">itk::Command</a></div><div class="ttdeci">class ITK_FORWARD_EXPORT Command</div><div class="ttdef"><b>Definition:</b> <a href="itkObject_8h_source.html#l00043">itkObject.h:43</a></div></div>
<div class="ttc" id="aclassitk_1_1GradientMagnitudeRecursiveGaussianImageFilter_html"><div class="ttname"><a href="classitk_1_1GradientMagnitudeRecursiveGaussianImageFilter.html">itk::GradientMagnitudeRecursiveGaussianImageFilter</a></div><div class="ttdoc">Computes the Magnitude of the Gradient of an image by convolution with the first derivative of a Gaus...</div><div class="ttdef"><b>Definition:</b> <a href="itkGradientMagnitudeRecursiveGaussianImageFilter_8h_source.html#l00050">itkGradientMagnitudeRecursiveGaussianImageFilter.h:50</a></div></div>
<div class="ttc" id="aitkOnePlusOneEvolutionaryOptimizer_8h_html"><div class="ttname"><a href="itkOnePlusOneEvolutionaryOptimizer_8h.html">itkOnePlusOneEvolutionaryOptimizer.h</a></div></div>
<div class="ttc" id="aclassitk_1_1Command_html_aa63870ad4b3927aaf128866ef161b208"><div class="ttname"><a href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">itk::Command::Execute</a></div><div class="ttdeci">virtual void Execute(Object *caller, const EventObject &amp;event)=0</div></div>
<div class="ttc" id="aitkRescaleIntensityImageFilter_8h_html"><div class="ttname"><a href="itkRescaleIntensityImageFilter_8h.html">itkRescaleIntensityImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1NumericSeriesFileNames_html_a5155882e4b775cac5646a24a332af623"><div class="ttname"><a href="classitk_1_1NumericSeriesFileNames.html#a5155882e4b775cac5646a24a332af623">itk::NumericSeriesFileNames::New</a></div><div class="ttdeci">static Pointer New()</div></div>
<div class="ttc" id="aclassitk_1_1Euler2DTransform_html"><div class="ttname"><a href="classitk_1_1Euler2DTransform.html">itk::Euler2DTransform</a></div><div class="ttdoc">Euler2DTransform of a vector space (e.g. space coordinates)</div><div class="ttdef"><b>Definition:</b> <a href="itkEuler2DTransform_8h_source.html#l00041">itkEuler2DTransform.h:41</a></div></div>
<div class="ttc" id="aitkImageFileWriter_8h_html"><div class="ttname"><a href="itkImageFileWriter_8h.html">itkImageFileWriter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1GeodesicActiveContourShapePriorLevelSetImageFilter_html"><div class="ttname"><a href="classitk_1_1GeodesicActiveContourShapePriorLevelSetImageFilter.html">itk::GeodesicActiveContourShapePriorLevelSetImageFilter</a></div><div class="ttdoc">Segments structures in an image based on a user supplied edge potential map and user supplied shape m...</div><div class="ttdef"><b>Definition:</b> <a href="itkGeodesicActiveContourShapePriorLevelSetImageFilter_8h_source.html#l00111">itkGeodesicActiveContourShapePriorLevelSetImageFilter.h:111</a></div></div>
<div class="ttc" id="aitkNormalVariateGenerator_8h_html"><div class="ttname"><a href="itkNormalVariateGenerator_8h.html">itkNormalVariateGenerator.h</a></div></div>
<div class="ttc" id="aclassitk_1_1Object_html"><div class="ttname"><a href="classitk_1_1Object.html">itk::Object</a></div><div class="ttdoc">Base class for most ITK classes.</div><div class="ttdef"><b>Definition:</b> <a href="itkObject_8h_source.html#l00062">itkObject.h:62</a></div></div>
<div class="ttc" id="aclassitk_1_1RescaleIntensityImageFilter_html"><div class="ttname"><a href="classitk_1_1RescaleIntensityImageFilter.html">itk::RescaleIntensityImageFilter</a></div><div class="ttdoc">Applies a linear transformation to the intensity levels of the input Image.</div><div class="ttdef"><b>Definition:</b> <a href="itkRescaleIntensityImageFilter_8h_source.html#l00147">itkRescaleIntensityImageFilter.h:147</a></div></div>
<div class="ttc" id="anamespaceitk_1_1Math_html_af105436026645171db6a4a3000ee8482"><div class="ttname"><a href="namespaceitk_1_1Math.html#af105436026645171db6a4a3000ee8482">itk::Math::e</a></div><div class="ttdeci">static constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="itkMath_8h_source.html#l00054">itkMath.h:54</a></div></div>
<div class="ttc" id="aitkBinaryThresholdImageFilter_8h_html"><div class="ttname"><a href="itkBinaryThresholdImageFilter_8h.html">itkBinaryThresholdImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1Image_html"><div class="ttname"><a href="classitk_1_1Image.html">itk::Image</a></div><div class="ttdoc">Templated n-dimensional image class.</div><div class="ttdef"><b>Definition:</b> <a href="itkImage_8h_source.html#l00088">itkImage.h:88</a></div></div>
<div class="ttc" id="aclassitk_1_1EventObject_html"><div class="ttname"><a href="classitk_1_1EventObject.html">itk::EventObject</a></div><div class="ttdoc">Abstraction of the Events used to communicating among filters and with GUIs.</div><div class="ttdef"><b>Definition:</b> <a href="itkEventObject_8h_source.html#l00057">itkEventObject.h:57</a></div></div>
<div class="ttc" id="aclassitk_1_1OnePlusOneEvolutionaryOptimizer_html"><div class="ttname"><a href="classitk_1_1OnePlusOneEvolutionaryOptimizer.html">itk::OnePlusOneEvolutionaryOptimizer</a></div><div class="ttdoc">1+1 evolutionary strategy optimizer</div><div class="ttdef"><b>Definition:</b> <a href="itkOnePlusOneEvolutionaryOptimizer_8h_source.html#l00071">itkOnePlusOneEvolutionaryOptimizer.h:71</a></div></div>
<div class="ttc" id="aitkAddImageFilter_8h_html_a3a600dc8aa7dad7b4c1e9d190d4f8c92"><div class="ttname"><a href="itkAddImageFilter_8h.html#a3a600dc8aa7dad7b4c1e9d190d4f8c92">New</a></div><div class="ttdeci">static Pointer New()</div></div>
<div class="ttc" id="aclassAddImageFilter_html"><div class="ttname"><a href="classAddImageFilter.html">AddImageFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="itkAddImageFilter_8h_source.html#l00080">itkAddImageFilter.h:80</a></div></div>
<div class="ttc" id="aitkGeodesicActiveContourShapePriorLevelSetImageFilter_8h_html"><div class="ttname"><a href="itkGeodesicActiveContourShapePriorLevelSetImageFilter_8h.html">itkGeodesicActiveContourShapePriorLevelSetImageFilter.h</a></div></div>
<div class="ttc" id="anamespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2_html_a3c1343e7d285fc01106df9e0c28d5154"><div class="ttname"><a href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#a3c1343e7d285fc01106df9e0c28d5154">itk::GTest::TypedefsAndConstructors::Dimension2::Dimension</a></div><div class="ttdeci">constexpr unsigned int Dimension</div><div class="ttdef"><b>Definition:</b> <a href="itkGTestTypedefsAndConstructors_8h_source.html#l00044">itkGTestTypedefsAndConstructors.h:44</a></div></div>
<div class="ttc" id="aitkCommand_8h_html"><div class="ttname"><a href="itkCommand_8h.html">itkCommand.h</a></div></div>
<div class="ttc" id="aitkAddImageFilter_8h_html_a8c77390f5f26f2ec5a75801152e1f673"><div class="ttname"><a href="itkAddImageFilter_8h.html#a8c77390f5f26f2ec5a75801152e1f673">Superclass</a></div><div class="ttdeci">BinaryGeneratorImageFilter&lt; TInputImage1, TInputImage2, TOutputImage &gt; Superclass</div><div class="ttdef"><b>Definition:</b> <a href="itkAddImageFilter_8h_source.html#l00089">itkAddImageFilter.h:89</a></div></div>
<div class="ttc" id="aitkChangeInformationImageFilter_8h_html"><div class="ttname"><a href="itkChangeInformationImageFilter_8h.html">itkChangeInformationImageFilter.h</a></div></div>
<div class="ttc" id="aitkPCAShapeSignedDistanceFunction_8h_html"><div class="ttname"><a href="itkPCAShapeSignedDistanceFunction_8h.html">itkPCAShapeSignedDistanceFunction.h</a></div></div>
<div class="ttc" id="aitkGradientMagnitudeRecursiveGaussianImageFilter_8h_html"><div class="ttname"><a href="itkGradientMagnitudeRecursiveGaussianImageFilter_8h.html">itkGradientMagnitudeRecursiveGaussianImageFilter.h</a></div></div>
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<hr class="footer"/>
<div class="footer" align="left">
  <small>Tarballs of the nightly generated Doxygen documentation are available
    for the
    <a href="http://public.kitware.com/pub/itk/NightlyDoxygen/InsightDoxygenDocHtml.tar.gz">html</a>,
    <a href="http://public.kitware.com/pub/itk/NightlyDoxygen/InsightDoxygenDocXml.tar.gz">xml</a>, and
    <a href="http://public.kitware.com/pub/itk/NightlyDoxygen/InsightDoxygenDocTag.gz">tag file</a>.
  </small>
</div>
<address class="footer"><small>
Generated on <span id="datetime">unknown</span> for ITK by &#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
