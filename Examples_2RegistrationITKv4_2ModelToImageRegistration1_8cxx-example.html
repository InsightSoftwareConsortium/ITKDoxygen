<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ITK: Examples/RegistrationITKv4/ModelToImageRegistration1.cxx</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="ITK"/>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<script type="text/javascript" src="build_text.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ITKDoxygenStyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="itkLogoSmall.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ITK
   &#160;<span id="projectnumber">5.3.0</span>
   </div>
   <div id="projectbrief">Insight Toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--  Scripts intended to allow users to submit patches with documentation fixes -->
<!-- <script src="https://www.itk.org/Doxygen/js/jquery-1.4.3.min.js" type="text/javascript" charset="utf-8"></script> -->
<!-- <script src="https://www.itk.org/Doxygen/js/editdoxygen.js" type="text/javascript" charset="utf-8"></script> -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,true,'search.php','Search');
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Examples/RegistrationITKv4/ModelToImageRegistration1.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*=========================================================================</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Copyright NumFOCUS</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment"> *  you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment"> *  You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *         http://www.apache.org/licenses/LICENSE-2.0.txt</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment"> *  See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment"> *  limitations under the License.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *=========================================================================*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  This example illustrates the use of the \doxygen{SpatialObject} as a</span></div>
<div class="line"><span class="comment">//  component of the registration framework in order to perform model based</span></div>
<div class="line"><span class="comment">//  registration. The current example creates a geometrical model composed of</span></div>
<div class="line"><span class="comment">//  several ellipses. Then, it uses the model to produce a synthetic binary</span></div>
<div class="line"><span class="comment">//  image of the ellipses. Next, it introduces perturbations on the position</span></div>
<div class="line"><span class="comment">//  and shape of the model, and finally it uses the perturbed version as the</span></div>
<div class="line"><span class="comment">//  input to a registration problem. A metric is defined to evaluate the</span></div>
<div class="line"><span class="comment">//  fitness between the geometric model and the image.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Let&#39;s look first at the classes required to support</span></div>
<div class="line"><span class="comment">//  SpatialObject. In this example we use the</span></div>
<div class="line"><span class="comment">//  \doxygen{EllipseSpatialObject} as the basic shape components and we use</span></div>
<div class="line"><span class="comment">//  the \doxygen{GroupSpatialObject} to group them together as a</span></div>
<div class="line"><span class="comment">//  representation of a more complex shape. Their respective headers are</span></div>
<div class="line"><span class="comment">//  included below.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  \index{itk::EllipseSpatialObject!header}</span></div>
<div class="line"><span class="comment">//  \index{itk::GroupSpatialObject!header}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkEllipseSpatialObject_8h.html">itkEllipseSpatialObject.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkGroupSpatialObject_8h.html">itkGroupSpatialObject.h</a>&quot;</span></div>
<div class="line"><span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  In order to generate the initial synthetic image of the ellipses, we use</span></div>
<div class="line"><span class="comment">//  the \doxygen{SpatialObjectToImageFilter} that tests---for every pixel in</span></div>
<div class="line"><span class="comment">//  the image---whether the pixel (and hence the spatial object) is</span></div>
<div class="line"><span class="comment">//  \emph{inside} or \emph{outside} the geometric model.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  \index{itk::Spatial\-Object\-To\-Image\-Filter!header}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkSpatialObjectToImageFilter_8h.html">itkSpatialObjectToImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkImageToSpatialObjectRegistrationMethod_8h.html">itkImageToSpatialObjectRegistrationMethod.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  A metric is defined to evaluate the fitness between the</span></div>
<div class="line"><span class="comment">//  SpatialObject and the Image. The base class for this</span></div>
<div class="line"><span class="comment">//  type of metric is the \doxygen{ImageToSpatialObjectMetric}, whose header</span></div>
<div class="line"><span class="comment">//  is included below.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Metric!header}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkImageToSpatialObjectMetric_8h.html">itkImageToSpatialObjectMetric.h</a>&quot;</span></div>
<div class="line"><span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  As in previous registration problems, we have to evaluate the image</span></div>
<div class="line"><span class="comment">//  intensity in non-grid positions. The</span></div>
<div class="line"><span class="comment">//  \doxygen{LinearInterpolateImageFunction} is used here for this purpose.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  \index{itk::Linear\-Interpolate\-Image\-Function!header}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkLinearInterpolateImageFunction_8h.html">itkLinearInterpolateImageFunction.h</a>&quot;</span></div>
<div class="line"><span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  The SpatialObject is mapped from its own space into the image</span></div>
<div class="line"><span class="comment">//  space by using a \doxygen{Transform}. In this</span></div>
<div class="line"><span class="comment">//  example, we use the \doxygen{Euler2DTransform}.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkEuler2DTransform_8h.html">itkEuler2DTransform.h</a>&quot;</span></div>
<div class="line"><span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Registration is fundamentally an optimization problem. Here we include</span></div>
<div class="line"><span class="comment">//  the optimizer used to search the parameter space and identify the best</span></div>
<div class="line"><span class="comment">//  transformation that will map the shape model on top of the image. The</span></div>
<div class="line"><span class="comment">//  optimizer used in this example is the</span></div>
<div class="line"><span class="comment">//  \doxygen{OnePlusOneEvolutionaryOptimizer} that implements an</span></div>
<div class="line"><span class="comment">//  \href{http://www.aic.nrl.navy.mil/galist/}{evolutionary algorithm}.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkOnePlusOneEvolutionaryOptimizer_8h.html">itkOnePlusOneEvolutionaryOptimizer.h</a>&quot;</span></div>
<div class="line"><span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkDiscreteGaussianImageFilter_8h.html">itkDiscreteGaussianImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkNormalVariateGenerator_8h.html">itkNormalVariateGenerator.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkImageFileReader_8h.html">itkImageFileReader.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkImageFileWriter_8h.html">itkImageFileWriter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkCastImageFilter_8h.html">itkCastImageFilter.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkRescaleIntensityImageFilter_8h.html">itkRescaleIntensityImageFilter.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  As in previous registration examples, it is important to</span></div>
<div class="line"><span class="comment">//  track the evolution of the optimizer as it progresses through the</span></div>
<div class="line"><span class="comment">//  parameter space.  This is done by using the Command/Observer paradigm. The</span></div>
<div class="line"><span class="comment">//  following lines of code implement the \doxygen{Command} observer that</span></div>
<div class="line"><span class="comment">//  monitors the progress of the registration. The code is quite</span></div>
<div class="line"><span class="comment">//  similar to what we have used in previous registration examples.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  \index{Model to Image Registration!Observer}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="itkCommand_8h.html">itkCommand.h</a>&quot;</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> TOptimizer&gt;</div>
<div class="line"><span class="keyword">class </span>IterationCallback : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="classitk_1_1Command.html">itk::Command</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">using</span> Self = IterationCallback;</div>
<div class="line">  <span class="keyword">using</span> Superclass = <a name="a1"></a><a class="code" href="namespaceitk.html#af2b97d337bf8035236a54a91fdcf040a">itk::Command</a>;</div>
<div class="line">  <span class="keyword">using</span> Pointer = <a name="_a2"></a><a class="code" href="classitk_1_1SmartPointer.html">itk::SmartPointer&lt;Self&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> ConstPointer = <a name="_a3"></a><a class="code" href="classitk_1_1SmartPointer.html">itk::SmartPointer&lt;const Self&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  itkTypeMacro(IterationCallback, Superclass);</div>
<div class="line">  itkNewMacro(Self);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> OptimizerType = TOptimizer;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  SetOptimizer(OptimizerType * optimizer)</div>
<div class="line">  {</div>
<div class="line">    m_Optimizer = optimizer;</div>
<div class="line">    m_Optimizer-&gt;AddObserver(itk::IterationEvent(), <span class="keyword">this</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a name="a4"></a><a class="code" href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">Execute</a>(<a name="_a5"></a><a class="code" href="classitk_1_1Object.html">itk::Object</a> * caller, <span class="keyword">const</span> <a name="_a6"></a><a class="code" href="classitk_1_1EventObject.html">itk::EventObject</a> &amp; event)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">Execute</a>((<span class="keyword">const</span> <a class="code" href="classitk_1_1Object.html">itk::Object</a> *)caller, event);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a class="code" href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">Execute</a>(<span class="keyword">const</span> <a class="code" href="classitk_1_1Object.html">itk::Object</a> *, <span class="keyword">const</span> <a class="code" href="classitk_1_1EventObject.html">itk::EventObject</a> &amp; event)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">typeid</span>(event) == <span class="keyword">typeid</span>(itk::StartEvent))</div>
<div class="line">    {</div>
<div class="line">      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Position              Value&quot;</span>;</div>
<div class="line">      std::cout &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">typeid</span>(event) == <span class="keyword">typeid</span>(itk::IterationEvent))</div>
<div class="line">    {</div>
<div class="line">      std::cout &lt;&lt; m_Optimizer-&gt;GetCurrentIteration() &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line">      std::cout &lt;&lt; m_Optimizer-&gt;GetValue() &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div>
<div class="line">      std::cout &lt;&lt; m_Optimizer-&gt;GetCurrentPosition() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">typeid</span>(event) == <span class="keyword">typeid</span>(itk::EndEvent))</div>
<div class="line">    {</div>
<div class="line">      std::cout &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;After &quot;</span> &lt;&lt; m_Optimizer-&gt;GetCurrentIteration();</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;  iterations &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Solution is    = &quot;</span> &lt;&lt; m_Optimizer-&gt;GetCurrentPosition();</div>
<div class="line">      std::cout &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  IterationCallback() = <span class="keywordflow">default</span>;</div>
<div class="line">  <a name="_a7"></a><a class="code" href="classitk_1_1WeakPointer.html">itk::WeakPointer&lt;OptimizerType&gt;</a> m_Optimizer;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  This command will be invoked at every iteration of the optimizer and will</span></div>
<div class="line"><span class="comment">//  print out the current combination of transform parameters.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Consider now the most critical component of this new registration</span></div>
<div class="line"><span class="comment">//  approach: the metric.  This component evaluates the match between the</span></div>
<div class="line"><span class="comment">//  SpatialObject and the Image. The</span></div>
<div class="line"><span class="comment">//  smoothness and regularity of the metric determine the difficulty of the</span></div>
<div class="line"><span class="comment">//  task assigned to the optimizer. In this case, we use a very robust</span></div>
<div class="line"><span class="comment">//  optimizer that should be able to find its way even in the most</span></div>
<div class="line"><span class="comment">//  discontinuous cost functions. The metric to be implemented should derive</span></div>
<div class="line"><span class="comment">//  from the ImageToSpatialObjectMetric class.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  The following code implements a simple metric that computes the sum of</span></div>
<div class="line"><span class="comment">//  the pixels that are inside the spatial object. In fact, the metric</span></div>
<div class="line"><span class="comment">//  maximum is obtained when the model and the image are aligned. The metric</span></div>
<div class="line"><span class="comment">//  is templated over the type of the SpatialObject and the type of</span></div>
<div class="line"><span class="comment">//  the Image.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> TFixedImage, <span class="keyword">typename</span> TMovingSpatialObject&gt;</div>
<div class="line"><span class="keyword">class </span>SimpleImageToSpatialObjectMetric</div>
<div class="line">  : <span class="keyword">public</span> <a name="_a8"></a><a class="code" href="classitk_1_1ImageToSpatialObjectMetric.html">itk::ImageToSpatialObjectMetric</a>&lt;TFixedImage, TMovingSpatialObject&gt;</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">using</span> Self = SimpleImageToSpatialObjectMetric;</div>
<div class="line">  <span class="keyword">using</span> Superclass =</div>
<div class="line">    <a class="code" href="classitk_1_1ImageToSpatialObjectMetric.html">itk::ImageToSpatialObjectMetric&lt;TFixedImage, TMovingSpatialObject&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> Pointer = <a class="code" href="classitk_1_1SmartPointer.html">itk::SmartPointer&lt;Self&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> ConstPointer = <a class="code" href="classitk_1_1SmartPointer.html">itk::SmartPointer&lt;const Self&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a name="a9"></a><a class="code" href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#a4e283d9983c57c5015a80d0b1d1cf09f">PointType</a> = <a name="_a10"></a><a class="code" href="classitk_1_1Point.html">itk::Point&lt;double, 2&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> PointListType = std::list&lt;PointType&gt;;</div>
<div class="line">  <span class="keyword">using</span> MovingSpatialObjectType = TMovingSpatialObject;</div>
<div class="line">  <span class="keyword">using</span> <span class="keyword">typename</span> <a name="a11"></a><a class="code" href="classitk_1_1SingleValuedCostFunction.html#add8c412bb10134d476a9c98584d0da2f">Superclass::ParametersType</a>;</div>
<div class="line">  <span class="keyword">using</span> <span class="keyword">typename</span> <a name="a12"></a><a class="code" href="classitk_1_1SingleValuedCostFunction.html#a3040b706e83393aa406681524a5851e7">Superclass::DerivativeType</a>;</div>
<div class="line">  <span class="keyword">using</span> <span class="keyword">typename</span> <a name="a13"></a><a class="code" href="classitk_1_1SingleValuedCostFunction.html#a153ff76be5fa24aaf0b8f05552a8a579">Superclass::MeasureType</a>;</div>
<div class="line"> </div>
<div class="line">  itkNewMacro(Self);</div>
<div class="line"> </div>
<div class="line">  itkTypeMacro(SimpleImageToSpatialObjectMetric, ImageToSpatialObjectMetric);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ParametricSpaceDimension = 3;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a name="a14"></a><a class="code" href="classitk_1_1ImageToSpatialObjectMetric.html#ad637edb79ec84f907d3d831c9cbfc85c">SetMovingSpatialObject</a>(<span class="keyword">const</span> MovingSpatialObjectType * <span class="keywordtype">object</span>)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (!this-&gt;m_FixedImage)</div>
<div class="line">    {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Please set the image before the moving spatial object&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    this-&gt;m_MovingSpatialObject = object;</div>
<div class="line">    m_PointList.clear();</div>
<div class="line">    <span class="keyword">using</span> myIteratorType =</div>
<div class="line">      <a name="_a15"></a><a class="code" href="classitk_1_1ImageRegionConstIteratorWithIndex.html">itk::ImageRegionConstIteratorWithIndex&lt;TFixedImage&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    myIteratorType it(this-&gt;m_FixedImage,</div>
<div class="line">                      this-&gt;m_FixedImage-&gt;GetBufferedRegion());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classitk_1_1Point.html">itk::Point&lt;double, 2&gt;</a> point;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (!it.IsAtEnd())</div>
<div class="line">    {</div>
<div class="line">      this-&gt;m_FixedImage-&gt;TransformIndexToPhysicalPoint(it.GetIndex(), point);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (this-&gt;m_MovingSpatialObject-&gt;IsInsideInWorldSpace(point, 99999))</div>
<div class="line">      {</div>
<div class="line">        m_PointList.push_back(point);</div>
<div class="line">      }</div>
<div class="line">      ++it;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Number of points in the metric = &quot;</span></div>
<div class="line">              &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span><span class="keyword">&gt;</span>(m_PointList.size()) &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a name="a16"></a><a class="code" href="classitk_1_1SingleValuedCostFunction.html#ab221de11a302d91ccdd00368a17fd129">GetDerivative</a>(<span class="keyword">const</span> ParametersType &amp;, DerivativeType &amp;)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The fundamental operation of the metric is its \code{GetValue()} method.</span></div>
<div class="line">  <span class="comment">//  It is in this method that the fitness value is computed. In our current</span></div>
<div class="line">  <span class="comment">//  example, the fitness is computed over the points of the</span></div>
<div class="line">  <span class="comment">//  SpatialObject. For each point, its coordinates are mapped</span></div>
<div class="line">  <span class="comment">//  through the transform into image space. The resulting point is used</span></div>
<div class="line">  <span class="comment">//  to evaluate the image and the resulting value is accumulated in a sum.</span></div>
<div class="line">  <span class="comment">//  Since we are not allowing scale changes, the optimal value of the sum</span></div>
<div class="line">  <span class="comment">//  will result when all the SpatialObject points are mapped on</span></div>
<div class="line">  <span class="comment">//  the white regions of the image. Note that the argument for the</span></div>
<div class="line">  <span class="comment">//  \code{GetValue()} method is the array of parameters of the transform.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{Image\-To\-Spatial\-Object\-Metric!GetValue()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  MeasureType</div>
<div class="line">  <a name="a17"></a><a class="code" href="classitk_1_1SingleValuedCostFunction.html#a8d21f6a4fafb79760b61967a1617c380">GetValue</a>(<span class="keyword">const</span> ParametersType &amp; parameters)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordtype">double</span> value;</div>
<div class="line">    this-&gt;m_Transform-&gt;SetParameters(parameters);</div>
<div class="line"> </div>
<div class="line">    value = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : m_PointList)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#a4e283d9983c57c5015a80d0b1d1cf09f">PointType</a> transformedPoint = this-&gt;m_Transform-&gt;TransformPoint(it);</div>
<div class="line">      <span class="keywordflow">if</span> (this-&gt;m_Interpolator-&gt;IsInsideBuffer(transformedPoint))</div>
<div class="line">      {</div>
<div class="line">        value += this-&gt;m_Interpolator-&gt;Evaluate(transformedPoint);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> value;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  <a name="a18"></a><a class="code" href="classitk_1_1ImageToSpatialObjectMetric.html#aea2a427b9c5b4da7dd4e685546aceb78">GetValueAndDerivative</a>(<span class="keyword">const</span> ParametersType &amp; parameters,</div>
<div class="line">                        MeasureType &amp;          Value,</div>
<div class="line">                        DerivativeType &amp;       Derivative)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    Value = this-&gt;<a class="code" href="classitk_1_1SingleValuedCostFunction.html#a8d21f6a4fafb79760b61967a1617c380">GetValue</a>(parameters);</div>
<div class="line">    this-&gt;<a class="code" href="classitk_1_1SingleValuedCostFunction.html#ab221de11a302d91ccdd00368a17fd129">GetDerivative</a>(parameters, Derivative);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  PointListType m_PointList;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Having defined all the registration components we are ready to put the</span></div>
<div class="line"><span class="comment">//  pieces together and implement the registration process.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (argc &gt; 1)</div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Too many parameters &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  First we instantiate the GroupSpatialObject and</span></div>
<div class="line">  <span class="comment">//  EllipseSpatialObject. These two objects are parameterized by</span></div>
<div class="line">  <span class="comment">//  the dimension of the space. In our current example a $2D$ instantiation</span></div>
<div class="line">  <span class="comment">//  is created.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{Group\-Spatial\-Object!Instantiation}</span></div>
<div class="line">  <span class="comment">//  \index{Ellipse\-Spatial\-Object!Instantiation}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> GroupType = <a name="_a19"></a><a class="code" href="classitk_1_1GroupSpatialObject.html">itk::GroupSpatialObject&lt;2&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> EllipseType = <a name="_a20"></a><a class="code" href="classitk_1_1EllipseSpatialObject.html">itk::EllipseSpatialObject&lt;2&gt;</a>;</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The image is instantiated in the following lines using the pixel</span></div>
<div class="line">  <span class="comment">//  type and the space dimension. This image uses a \code{float} pixel</span></div>
<div class="line">  <span class="comment">//  type since we plan to blur it in order to increase the capture radius of</span></div>
<div class="line">  <span class="comment">//  the optimizer. Images of real pixel type behave better under blurring</span></div>
<div class="line">  <span class="comment">//  than those of integer pixel type.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> ImageType = <a name="_a21"></a><a class="code" href="classitk_1_1Image.html">itk::Image&lt;float, 2&gt;</a>;</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Here is where the fun begins! In the following lines we create the</span></div>
<div class="line">  <span class="comment">//  EllipseSpatialObjects using their \code{New()} methods, and</span></div>
<div class="line">  <span class="comment">//  assigning the results to SmartPointers. These lines will create</span></div>
<div class="line">  <span class="comment">//  three ellipses.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">auto</span> ellipse1 = EllipseType::New();</div>
<div class="line">  <span class="keyword">auto</span> ellipse2 = EllipseType::New();</div>
<div class="line">  <span class="keyword">auto</span> ellipse3 = EllipseType::New();</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Every class deriving from SpatialObject has particular</span></div>
<div class="line">  <span class="comment">//  parameters enabling the user to tailor its shape. In the case of the</span></div>
<div class="line">  <span class="comment">//  EllipseSpatialObject, \code{SetRadius()} is used to</span></div>
<div class="line">  <span class="comment">//  define the ellipse size. An additional \code{SetRadius(Array)} method</span></div>
<div class="line">  <span class="comment">//  allows the user to define the ellipse axes independently.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::EllipseSpatialObject!SetRadius()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  ellipse1-&gt;SetRadiusInObjectSpace(10.0);</div>
<div class="line">  ellipse2-&gt;SetRadiusInObjectSpace(10.0);</div>
<div class="line">  ellipse3-&gt;SetRadiusInObjectSpace(10.0);</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The ellipses are created centered in space by default. We use the</span></div>
<div class="line">  <span class="comment">//  following lines of code to arrange the ellipses in a triangle.</span></div>
<div class="line">  <span class="comment">//  The spatial transform intrinsically associated with the object is</span></div>
<div class="line">  <span class="comment">//  accessed by the \code{GetTransform()} method. This transform can define</span></div>
<div class="line">  <span class="comment">//  a translation in space with the \code{SetOffset()} method.  We take</span></div>
<div class="line">  <span class="comment">//  advantage of this feature to place the ellipses at particular</span></div>
<div class="line">  <span class="comment">//  points in space.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Place each ellipse at the right position to form a triangle</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  EllipseType::TransformType::OffsetType offset;</div>
<div class="line">  offset[0] = 100.0;</div>
<div class="line">  offset[1] = 40.0;</div>
<div class="line"> </div>
<div class="line">  ellipse1-&gt;GetModifiableObjectToParentTransform()-&gt;SetOffset(offset);</div>
<div class="line">  ellipse1-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  offset[0] = 40.0;</div>
<div class="line">  offset[1] = 150.0;</div>
<div class="line">  ellipse2-&gt;GetModifiableObjectToParentTransform()-&gt;SetOffset(offset);</div>
<div class="line">  ellipse2-&gt;Update();</div>
<div class="line"> </div>
<div class="line">  offset[0] = 150.0;</div>
<div class="line">  offset[1] = 150.0;</div>
<div class="line">  ellipse3-&gt;GetModifiableObjectToParentTransform()-&gt;SetOffset(offset);</div>
<div class="line">  ellipse3-&gt;Update();</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Note that after a change has been made in the transform, the</span></div>
<div class="line">  <span class="comment">//  SpatialObject invokes the method</span></div>
<div class="line">  <span class="comment">//  \code{ComputeGlobalTransform()} in order to update its global</span></div>
<div class="line">  <span class="comment">//  transform.  The reason for doing this is that SpatialObjects</span></div>
<div class="line">  <span class="comment">//  can be arranged in hierarchies. It is then possible to change the</span></div>
<div class="line">  <span class="comment">//  position of a set of spatial objects by moving the parent of the group.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Now we add the three EllipseSpatialObjects to a</span></div>
<div class="line">  <span class="comment">//  GroupSpatialObject that will be subsequently passed on to the</span></div>
<div class="line">  <span class="comment">//  registration method. The GroupSpatialObject facilitates the</span></div>
<div class="line">  <span class="comment">//  management of the three ellipses as a higher level structure</span></div>
<div class="line">  <span class="comment">//  representing a complex shape. Groups can be nested any number of levels</span></div>
<div class="line">  <span class="comment">//  in order to represent shapes with higher detail.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::GroupSpatialObject!New()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::GroupSpatialObject!Pointer}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">auto</span> group = GroupType::New();</div>
<div class="line">  group-&gt;AddChild(ellipse1);</div>
<div class="line">  group-&gt;AddChild(ellipse2);</div>
<div class="line">  group-&gt;AddChild(ellipse3);</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Having the geometric model ready, we proceed to generate the binary</span></div>
<div class="line">  <span class="comment">//  image representing the imprint of the space occupied by the ellipses.</span></div>
<div class="line">  <span class="comment">//  The SpatialObjectToImageFilter is used to that end. Note that</span></div>
<div class="line">  <span class="comment">//  this filter is instantiated over the spatial object used and the image</span></div>
<div class="line">  <span class="comment">//  type to be generated.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Spatial\-Object\-To\-Image\-Filter!Instantiation}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> SpatialObjectToImageFilterType =</div>
<div class="line">    <a name="_a22"></a><a class="code" href="classitk_1_1SpatialObjectToImageFilter.html">itk::SpatialObjectToImageFilter&lt;GroupType, ImageType&gt;</a>;</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  With the defined type, we construct a filter using the \code{New()}</span></div>
<div class="line">  <span class="comment">//  method. The newly created filter is assigned to a SmartPointer.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::SpatialObjectToImageFilter!New()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::SpatialObjectToImageFilter!Pointer}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">auto</span> imageFilter = SpatialObjectToImageFilterType::New();</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The GroupSpatialObject is passed as input to the filter.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::SpatialObjectToImageFilter!SetInput()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  imageFilter-&gt;SetInput(group);</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The \doxygen{SpatialObjectToImageFilter} acts as a resampling filter.</span></div>
<div class="line">  <span class="comment">//  Therefore it requires the user to define the size of the desired output</span></div>
<div class="line">  <span class="comment">//  image. This is specified with the \code{SetSize()} method.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::SpatialObjectToImageFilter!SetSize()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <a name="a23"></a><a class="code" href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#aea16424ec17542804734482565dc4572">ImageType::SizeType</a> size;</div>
<div class="line">  size[0] = 200;</div>
<div class="line">  size[1] = 200;</div>
<div class="line">  imageFilter-&gt;<a name="a24"></a><a class="code" href="structitk_1_1Size.html#a59403dcbe6f841c6775a2d76d4f7850a">SetSize</a>(size);</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Finally we trigger the execution of the filter by calling the</span></div>
<div class="line">  <span class="comment">//  \code{Update()} method.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::SpatialObjectToImageFilter!Update()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  imageFilter-&gt;Update();</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  In order to obtain a smoother metric, we blur the image using a</span></div>
<div class="line">  <span class="comment">//  \doxygen{DiscreteGaussianImageFilter}. This extends the capture radius</span></div>
<div class="line">  <span class="comment">//  of the metric and produce a more continuous cost function to</span></div>
<div class="line">  <span class="comment">//  optimize. The following lines instantiate the Gaussian filter and</span></div>
<div class="line">  <span class="comment">//  create one object of this type using the \code{New()} method.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> GaussianFilterType =</div>
<div class="line">    <a name="_a25"></a><a class="code" href="classitk_1_1DiscreteGaussianImageFilter.html">itk::DiscreteGaussianImageFilter&lt;ImageType, ImageType&gt;</a>;</div>
<div class="line">  <span class="keyword">auto</span> gaussianFilter = GaussianFilterType::New();</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The output of the SpatialObjectToImageFilter is connected as</span></div>
<div class="line">  <span class="comment">//  input to the DiscreteGaussianImageFilter.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  gaussianFilter-&gt;SetInput(imageFilter-&gt;GetOutput());</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The variance of the filter is defined as a large value in order to</span></div>
<div class="line">  <span class="comment">//  increase the capture radius. Finally the execution of the filter is</span></div>
<div class="line">  <span class="comment">//  triggered using the \code{Update()} method.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginCodeSnippet</span></div>
<div class="line">  constexpr <span class="keywordtype">double</span> variance = 20;</div>
<div class="line">  gaussianFilter-&gt;SetVariance(variance);</div>
<div class="line">  gaussianFilter-&gt;Update();</div>
<div class="line">  <span class="comment">//  Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Below we instantiate the type of the</span></div>
<div class="line">  <span class="comment">//  \doxygen{ImageToSpatialObjectRegistrationMethod} method and instantiate</span></div>
<div class="line">  <span class="comment">//  a registration object with the \code{New()} method. Note that the</span></div>
<div class="line">  <span class="comment">//  registration type is templated over the Image and the</span></div>
<div class="line">  <span class="comment">//  SpatialObject types. The spatial object in this case is the</span></div>
<div class="line">  <span class="comment">//  group of spatial objects.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!Instantiation}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!New()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!Pointer}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> RegistrationType =</div>
<div class="line">    <a name="_a26"></a><a class="code" href="classitk_1_1ImageToSpatialObjectRegistrationMethod.html">itk::ImageToSpatialObjectRegistrationMethod&lt;ImageType, GroupType&gt;</a>;</div>
<div class="line">  <span class="keyword">auto</span> registration = RegistrationType::New();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Now we instantiate the metric that is templated over</span></div>
<div class="line">  <span class="comment">//  the image type and the spatial object type. As usual, the \code{New()}</span></div>
<div class="line">  <span class="comment">//  method is used to create an object.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Metric!Instantiation}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> MetricType = SimpleImageToSpatialObjectMetric&lt;ImageType, GroupType&gt;;</div>
<div class="line">  <span class="keyword">auto</span> metric = MetricType::New();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  An interpolator will be needed to evaluate the image at non-grid</span></div>
<div class="line">  <span class="comment">//  positions. Here we instantiate a linear interpolator type.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> InterpolatorType =</div>
<div class="line">    <a name="_a27"></a><a class="code" href="classitk_1_1LinearInterpolateImageFunction.html">itk::LinearInterpolateImageFunction&lt;ImageType, double&gt;</a>;</div>
<div class="line">  <span class="keyword">auto</span> interpolator = InterpolatorType::New();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The following lines instantiate the evolutionary optimizer.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::One\-Plus\-One\-Evolutionary\-Optimizer!Instantiation}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> OptimizerType = <a name="_a28"></a><a class="code" href="classitk_1_1OnePlusOneEvolutionaryOptimizer.html">itk::OnePlusOneEvolutionaryOptimizer</a>;</div>
<div class="line">  <span class="keyword">auto</span> optimizer = OptimizerType::New();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Next, we instantiate the transform class. In this case we use the</span></div>
<div class="line">  <span class="comment">//  Euler2DTransform that implements a rigid transform in $2D$</span></div>
<div class="line">  <span class="comment">//  space.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> TransformType = <a name="_a29"></a><a class="code" href="classitk_1_1Euler2DTransform.html">itk::Euler2DTransform&lt;&gt;</a>;</div>
<div class="line">  <span class="keyword">auto</span> transform = TransformType::New();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Evolutionary algorithms are based on testing random variations</span></div>
<div class="line">  <span class="comment">//  of parameters. In order to support the computation of random values,</span></div>
<div class="line">  <span class="comment">//  ITK provides a family of random number generators. In this example, we</span></div>
<div class="line">  <span class="comment">//  use the \doxygen{NormalVariateGenerator} which generates values with a</span></div>
<div class="line">  <span class="comment">//  normal distribution.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::NormalVariateGenerator!New()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::NormalVariateGenerator!Pointer}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">auto</span> generator = <a name="a30"></a><a class="code" href="classitk_1_1Statistics_1_1NormalVariateGenerator.html#a07a6a6afa0d73ee0c08f9e4e2bae1698">itk::Statistics::NormalVariateGenerator::New</a>();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The random number generator must be initialized with a seed.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::NormalVariateGenerator!Initialize()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  generator-&gt;Initialize(12345);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The OnePlusOneEvolutionaryOptimizer is initialized by</span></div>
<div class="line">  <span class="comment">//  specifying the random number generator, the number of samples for the</span></div>
<div class="line">  <span class="comment">//  initial population and the maximum number of iterations.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  optimizer-&gt;SetNormalVariateGenerator(generator);</div>
<div class="line">  optimizer-&gt;Initialize(10);</div>
<div class="line">  optimizer-&gt;SetMaximumIteration(400);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  As in previous registration examples, we take care to normalize the</span></div>
<div class="line">  <span class="comment">//  dynamic range of the different transform parameters. In particular, the</span></div>
<div class="line">  <span class="comment">//  we must compensate for the ranges of the angle and translations of the</span></div>
<div class="line">  <span class="comment">//  Euler2DTransform. In order to achieve this goal, we provide an array of</span></div>
<div class="line">  <span class="comment">//  scales to the optimizer.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  TransformType::ParametersType parametersScale;</div>
<div class="line">  parametersScale.set_size(3);</div>
<div class="line">  parametersScale[0] = 1000; <span class="comment">// angle scale</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; 3; ++i)</div>
<div class="line">  {</div>
<div class="line">    parametersScale[i] = 2; <span class="comment">// offset scale</span></div>
<div class="line">  }</div>
<div class="line">  optimizer-&gt;SetScales(parametersScale);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Here we instantiate the Command object that will act as an</span></div>
<div class="line">  <span class="comment">//  observer of the registration method and print out parameters at each</span></div>
<div class="line">  <span class="comment">//  iteration. Earlier, we defined this command as a class templated over</span></div>
<div class="line">  <span class="comment">//  the optimizer type. Once it is created with the \code{New()} method, we</span></div>
<div class="line">  <span class="comment">//  connect the optimizer to the command.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keyword">using</span> IterationCallbackType = IterationCallback&lt;OptimizerType&gt;;</div>
<div class="line">  <span class="keyword">auto</span> callback = IterationCallbackType::New();</div>
<div class="line">  callback-&gt;SetOptimizer(optimizer);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  All the components are plugged into the</span></div>
<div class="line">  <span class="comment">//  ImageToSpatialObjectRegistrationMethod object. The typical</span></div>
<div class="line">  <span class="comment">//  \code{Set()} methods are used here. Note the use of the</span></div>
<div class="line">  <span class="comment">//  \code{SetMovingSpatialObject()} method for connecting the spatial</span></div>
<div class="line">  <span class="comment">//  object. We provide the blurred version of the original synthetic binary</span></div>
<div class="line">  <span class="comment">//  image as the input image.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!SetFixedImage()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!SetMovingSpatialObject()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!SetTransform()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!SetInterpolator()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!SetOptimizer()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!SetMetric()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  registration-&gt;SetFixedImage(gaussianFilter-&gt;GetOutput());</div>
<div class="line">  registration-&gt;SetMovingSpatialObject(group);</div>
<div class="line">  registration-&gt;SetTransform(transform);</div>
<div class="line">  registration-&gt;SetInterpolator(interpolator);</div>
<div class="line">  registration-&gt;SetOptimizer(optimizer);</div>
<div class="line">  registration-&gt;SetMetric(metric);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The initial set of transform parameters is passed to the registration</span></div>
<div class="line">  <span class="comment">//  method using the \code{SetInitialTransformParameters()} method. Note</span></div>
<div class="line">  <span class="comment">//  that since our original model is already registered with the synthetic</span></div>
<div class="line">  <span class="comment">//  image, we introduce an artificial mis-registration in order to</span></div>
<div class="line">  <span class="comment">//  initialize the optimization at some point away from the optimal value.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  TransformType::ParametersType initialParameters(</div>
<div class="line">    transform-&gt;GetNumberOfParameters());</div>
<div class="line"> </div>
<div class="line">  initialParameters[0] = 0.2; <span class="comment">// Angle</span></div>
<div class="line">  initialParameters[1] = 7.0; <span class="comment">// Offset X</span></div>
<div class="line">  initialParameters[2] = 6.0; <span class="comment">// Offset Y</span></div>
<div class="line">  registration-&gt;SetInitialTransformParameters(initialParameters);</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Initial Parameters  : &quot;</span> &lt;&lt; initialParameters &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Due to the character of the metric used to evaluate the fitness</span></div>
<div class="line">  <span class="comment">//  between the spatial object and the image, we must tell the optimizer</span></div>
<div class="line">  <span class="comment">//  that we are interested in finding the maximum value of the metric. Some</span></div>
<div class="line">  <span class="comment">//  metrics associate low numeric values with good matching, while others</span></div>
<div class="line">  <span class="comment">//  associate high numeric values with good matching. The</span></div>
<div class="line">  <span class="comment">//  \code{MaximizeOn()} and \code{MaximizeOff()} methods allow the user to</span></div>
<div class="line">  <span class="comment">//  deal with both types of metrics.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Optimizer!MaximizeOn()}</span></div>
<div class="line">  <span class="comment">//  \index{itk::Optimizer!MaximizeOff()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  optimizer-&gt;MaximizeOn();</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Finally, we trigger the execution of the registration process with the</span></div>
<div class="line">  <span class="comment">//  \code{Update()} method. We place this call in a</span></div>
<div class="line">  <span class="comment">//  \code{try/catch} block in case any exception is thrown during the</span></div>
<div class="line">  <span class="comment">//  process.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!Update()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">  {</div>
<div class="line">    registration-&gt;Update();</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Optimizer stop condition: &quot;</span></div>
<div class="line">              &lt;&lt; registration-&gt;GetOptimizer()-&gt;GetStopConditionDescription()</div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<span class="keyword">const</span> itk::ExceptionObject &amp; exp)</div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception caught ! &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cerr &lt;&lt; exp &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The set of transform parameters resulting from the registration can be</span></div>
<div class="line">  <span class="comment">//  recovered with the \code{GetLastTransformParameters()} method. This</span></div>
<div class="line">  <span class="comment">//  method returns the array of transform parameters that should be</span></div>
<div class="line">  <span class="comment">//  interpreted according to the implementation of each transform. In our</span></div>
<div class="line">  <span class="comment">//  current example, the Euler2DTransform has three parameters:</span></div>
<div class="line">  <span class="comment">//  the rotation angle, the translation in $x$ and the translation in $y$.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  \index{itk::Image\-To\-Spatial\-Object\-Registration\-Method!Update()}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Software Guide : BeginCodeSnippet</span></div>
<div class="line">  RegistrationType::ParametersType finalParameters =</div>
<div class="line">    registration-&gt;GetLastTransformParameters();</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Final Solution is : &quot;</span> &lt;&lt; finalParameters &lt;&lt; std::endl;</div>
<div class="line">  <span class="comment">// Software Guide : EndCodeSnippet</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//  Software Guide : BeginLatex</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// \begin{figure}</span></div>
<div class="line">  <span class="comment">// \center</span></div>
<div class="line">  <span class="comment">// \includegraphics[height=0.44\textwidth]{ModelToImageRegistrationTraceAngle}</span></div>
<div class="line">  <span class="comment">// \includegraphics[height=0.44\textwidth]{ModelToImageRegistrationTraceTranslations}</span></div>
<div class="line">  <span class="comment">// \itkcaption[SpatialObject to Image Registration results]{Plots of the</span></div>
<div class="line">  <span class="comment">// angle and translation parameters for a registration process between an</span></div>
<div class="line">  <span class="comment">// spatial object and an image.}</span></div>
<div class="line">  <span class="comment">// \label{fig:ModelToImageRegistrationPlots}</span></div>
<div class="line">  <span class="comment">// \end{figure}</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  The results are presented in</span></div>
<div class="line">  <span class="comment">//  Figure~\ref{fig:ModelToImageRegistrationPlots}. The left side shows the</span></div>
<div class="line">  <span class="comment">//  evolution of the angle parameter as a function of iteration</span></div>
<div class="line">  <span class="comment">//  numbers, while the right side shows the $(x,y)$ translation.</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">//  Software Guide : EndLatex</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="aclassitk_1_1DiscreteGaussianImageFilter_html"><div class="ttname"><a href="classitk_1_1DiscreteGaussianImageFilter.html">itk::DiscreteGaussianImageFilter</a></div><div class="ttdoc">Blurs an image by separable convolution with discrete gaussian kernels. This filter performs Gaussian...</div><div class="ttdef"><b>Definition:</b> <a href="itkDiscreteGaussianImageFilter_8h_source.html#l00063">itkDiscreteGaussianImageFilter.h:63</a></div></div>
<div class="ttc" id="aclassitk_1_1ImageToSpatialObjectRegistrationMethod_html"><div class="ttname"><a href="classitk_1_1ImageToSpatialObjectRegistrationMethod.html">itk::ImageToSpatialObjectRegistrationMethod</a></div><div class="ttdoc">Base class for Image Registration Methods.</div><div class="ttdef"><b>Definition:</b> <a href="itkImageToSpatialObjectRegistrationMethod_8h_source.html#l00084">itkImageToSpatialObjectRegistrationMethod.h:84</a></div></div>
<div class="ttc" id="aclassitk_1_1SingleValuedCostFunction_html_a153ff76be5fa24aaf0b8f05552a8a579"><div class="ttname"><a href="classitk_1_1SingleValuedCostFunction.html#a153ff76be5fa24aaf0b8f05552a8a579">itk::SingleValuedCostFunction::MeasureType</a></div><div class="ttdeci">double MeasureType</div><div class="ttdef"><b>Definition:</b> <a href="itkSingleValuedCostFunction_8h_source.html#l00050">itkSingleValuedCostFunction.h:50</a></div></div>
<div class="ttc" id="aitkImageToSpatialObjectMetric_8h_html"><div class="ttname"><a href="itkImageToSpatialObjectMetric_8h.html">itkImageToSpatialObjectMetric.h</a></div></div>
<div class="ttc" id="aitkEuler2DTransform_8h_html"><div class="ttname"><a href="itkEuler2DTransform_8h.html">itkEuler2DTransform.h</a></div></div>
<div class="ttc" id="aclassitk_1_1ImageRegionConstIteratorWithIndex_html"><div class="ttname"><a href="classitk_1_1ImageRegionConstIteratorWithIndex.html">itk::ImageRegionConstIteratorWithIndex</a></div><div class="ttdoc">A multi-dimensional iterator templated over image type that walks an image region and is specialized ...</div><div class="ttdef"><b>Definition:</b> <a href="itkImageRegionConstIteratorWithIndex_8h_source.html#l00130">itkImageRegionConstIteratorWithIndex.h:130</a></div></div>
<div class="ttc" id="aitkLinearInterpolateImageFunction_8h_html"><div class="ttname"><a href="itkLinearInterpolateImageFunction_8h.html">itkLinearInterpolateImageFunction.h</a></div></div>
<div class="ttc" id="aclassitk_1_1ImageToSpatialObjectMetric_html_aea2a427b9c5b4da7dd4e685546aceb78"><div class="ttname"><a href="classitk_1_1ImageToSpatialObjectMetric.html#aea2a427b9c5b4da7dd4e685546aceb78">itk::ImageToSpatialObjectMetric::GetValueAndDerivative</a></div><div class="ttdeci">void GetValueAndDerivative(const ParametersType &amp;parameters, MeasureType &amp;Value, DerivativeType &amp;Derivative) const override=0</div></div>
<div class="ttc" id="aitkEllipseSpatialObject_8h_html"><div class="ttname"><a href="itkEllipseSpatialObject_8h.html">itkEllipseSpatialObject.h</a></div></div>
<div class="ttc" id="anamespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2_html_a4e283d9983c57c5015a80d0b1d1cf09f"><div class="ttname"><a href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#a4e283d9983c57c5015a80d0b1d1cf09f">itk::GTest::TypedefsAndConstructors::Dimension2::PointType</a></div><div class="ttdeci">ImageBaseType::PointType PointType</div><div class="ttdef"><b>Definition:</b> <a href="itkGTestTypedefsAndConstructors_8h_source.html#l00051">itkGTestTypedefsAndConstructors.h:51</a></div></div>
<div class="ttc" id="aitkImageFileReader_8h_html"><div class="ttname"><a href="itkImageFileReader_8h.html">itkImageFileReader.h</a></div></div>
<div class="ttc" id="anamespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2_html_aea16424ec17542804734482565dc4572"><div class="ttname"><a href="namespaceitk_1_1GTest_1_1TypedefsAndConstructors_1_1Dimension2.html#aea16424ec17542804734482565dc4572">itk::GTest::TypedefsAndConstructors::Dimension2::SizeType</a></div><div class="ttdeci">ImageBaseType::SizeType SizeType</div><div class="ttdef"><b>Definition:</b> <a href="itkGTestTypedefsAndConstructors_8h_source.html#l00049">itkGTestTypedefsAndConstructors.h:49</a></div></div>
<div class="ttc" id="aclassitk_1_1SpatialObjectToImageFilter_html"><div class="ttname"><a href="classitk_1_1SpatialObjectToImageFilter.html">itk::SpatialObjectToImageFilter</a></div><div class="ttdoc">Base class for filters that take a SpatialObject as input and produce an image as output....</div><div class="ttdef"><b>Definition:</b> <a href="itkSpatialObjectToImageFilter_8h_source.html#l00041">itkSpatialObjectToImageFilter.h:41</a></div></div>
<div class="ttc" id="aclassitk_1_1SmartPointer_html"><div class="ttname"><a href="classitk_1_1SmartPointer.html">itk::SmartPointer&lt; Self &gt;</a></div></div>
<div class="ttc" id="aitkImageToSpatialObjectRegistrationMethod_8h_html"><div class="ttname"><a href="itkImageToSpatialObjectRegistrationMethod_8h.html">itkImageToSpatialObjectRegistrationMethod.h</a></div></div>
<div class="ttc" id="aitkCastImageFilter_8h_html"><div class="ttname"><a href="itkCastImageFilter_8h.html">itkCastImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1SingleValuedCostFunction_html_ab221de11a302d91ccdd00368a17fd129"><div class="ttname"><a href="classitk_1_1SingleValuedCostFunction.html#ab221de11a302d91ccdd00368a17fd129">itk::SingleValuedCostFunction::GetDerivative</a></div><div class="ttdeci">virtual void GetDerivative(const ParametersType &amp;parameters, DerivativeType &amp;derivative) const =0</div></div>
<div class="ttc" id="aclassitk_1_1EllipseSpatialObject_html"><div class="ttname"><a href="classitk_1_1EllipseSpatialObject.html">itk::EllipseSpatialObject</a></div><div class="ttdef"><b>Definition:</b> <a href="itkEllipseSpatialObject_8h_source.html#l00038">itkEllipseSpatialObject.h:38</a></div></div>
<div class="ttc" id="aclassitk_1_1ImageToSpatialObjectMetric_html_ad637edb79ec84f907d3d831c9cbfc85c"><div class="ttname"><a href="classitk_1_1ImageToSpatialObjectMetric.html#ad637edb79ec84f907d3d831c9cbfc85c">itk::ImageToSpatialObjectMetric::SetMovingSpatialObject</a></div><div class="ttdeci">virtual void SetMovingSpatialObject(const MovingSpatialObjectType *_arg)</div></div>
<div class="ttc" id="aclassitk_1_1LinearInterpolateImageFunction_html"><div class="ttname"><a href="classitk_1_1LinearInterpolateImageFunction.html">itk::LinearInterpolateImageFunction</a></div><div class="ttdoc">Linearly interpolate an image at specified positions.</div><div class="ttdef"><b>Definition:</b> <a href="itkLinearInterpolateImageFunction_8h_source.html#l00050">itkLinearInterpolateImageFunction.h:50</a></div></div>
<div class="ttc" id="aclassitk_1_1Command_html"><div class="ttname"><a href="classitk_1_1Command.html">itk::Command</a></div><div class="ttdoc">Superclass for callback/observer methods.</div><div class="ttdef"><b>Definition:</b> <a href="itkCommand_8h_source.html#l00045">itkCommand.h:45</a></div></div>
<div class="ttc" id="aitkGroupSpatialObject_8h_html"><div class="ttname"><a href="itkGroupSpatialObject_8h.html">itkGroupSpatialObject.h</a></div></div>
<div class="ttc" id="aitkSpatialObjectToImageFilter_8h_html"><div class="ttname"><a href="itkSpatialObjectToImageFilter_8h.html">itkSpatialObjectToImageFilter.h</a></div></div>
<div class="ttc" id="anamespaceitk_html_af2b97d337bf8035236a54a91fdcf040a"><div class="ttname"><a href="namespaceitk.html#af2b97d337bf8035236a54a91fdcf040a">itk::Command</a></div><div class="ttdeci">class ITK_FORWARD_EXPORT Command</div><div class="ttdef"><b>Definition:</b> <a href="itkObject_8h_source.html#l00043">itkObject.h:43</a></div></div>
<div class="ttc" id="aitkOnePlusOneEvolutionaryOptimizer_8h_html"><div class="ttname"><a href="itkOnePlusOneEvolutionaryOptimizer_8h.html">itkOnePlusOneEvolutionaryOptimizer.h</a></div></div>
<div class="ttc" id="aclassitk_1_1Command_html_aa63870ad4b3927aaf128866ef161b208"><div class="ttname"><a href="classitk_1_1Command.html#aa63870ad4b3927aaf128866ef161b208">itk::Command::Execute</a></div><div class="ttdeci">virtual void Execute(Object *caller, const EventObject &amp;event)=0</div></div>
<div class="ttc" id="aitkRescaleIntensityImageFilter_8h_html"><div class="ttname"><a href="itkRescaleIntensityImageFilter_8h.html">itkRescaleIntensityImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1Euler2DTransform_html"><div class="ttname"><a href="classitk_1_1Euler2DTransform.html">itk::Euler2DTransform</a></div><div class="ttdoc">Euler2DTransform of a vector space (e.g. space coordinates)</div><div class="ttdef"><b>Definition:</b> <a href="itkEuler2DTransform_8h_source.html#l00041">itkEuler2DTransform.h:41</a></div></div>
<div class="ttc" id="aitkImageFileWriter_8h_html"><div class="ttname"><a href="itkImageFileWriter_8h.html">itkImageFileWriter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1SingleValuedCostFunction_html_add8c412bb10134d476a9c98584d0da2f"><div class="ttname"><a href="classitk_1_1SingleValuedCostFunction.html#add8c412bb10134d476a9c98584d0da2f">itk::SingleValuedCostFunction::ParametersType</a></div><div class="ttdeci">Superclass::ParametersType ParametersType</div><div class="ttdef"><b>Definition:</b> <a href="itkSingleValuedCostFunction_8h_source.html#l00054">itkSingleValuedCostFunction.h:54</a></div></div>
<div class="ttc" id="astructitk_1_1Size_html_a59403dcbe6f841c6775a2d76d4f7850a"><div class="ttname"><a href="structitk_1_1Size.html#a59403dcbe6f841c6775a2d76d4f7850a">itk::Size::SetSize</a></div><div class="ttdeci">void SetSize(const SizeValueType val[VDimension])</div><div class="ttdef"><b>Definition:</b> <a href="itkSize_8h_source.html#l00179">itkSize.h:179</a></div></div>
<div class="ttc" id="aclassitk_1_1WeakPointer_html"><div class="ttname"><a href="classitk_1_1WeakPointer.html">itk::WeakPointer&lt; OptimizerType &gt;</a></div></div>
<div class="ttc" id="aitkNormalVariateGenerator_8h_html"><div class="ttname"><a href="itkNormalVariateGenerator_8h.html">itkNormalVariateGenerator.h</a></div></div>
<div class="ttc" id="aclassitk_1_1Object_html"><div class="ttname"><a href="classitk_1_1Object.html">itk::Object</a></div><div class="ttdoc">Base class for most ITK classes.</div><div class="ttdef"><b>Definition:</b> <a href="itkObject_8h_source.html#l00062">itkObject.h:62</a></div></div>
<div class="ttc" id="aclassitk_1_1SingleValuedCostFunction_html_a8d21f6a4fafb79760b61967a1617c380"><div class="ttname"><a href="classitk_1_1SingleValuedCostFunction.html#a8d21f6a4fafb79760b61967a1617c380">itk::SingleValuedCostFunction::GetValue</a></div><div class="ttdeci">virtual MeasureType GetValue(const ParametersType &amp;parameters) const =0</div></div>
<div class="ttc" id="aclassitk_1_1Point_html"><div class="ttname"><a href="classitk_1_1Point.html">itk::Point&lt; double, 2 &gt;</a></div></div>
<div class="ttc" id="aclassitk_1_1Image_html"><div class="ttname"><a href="classitk_1_1Image.html">itk::Image</a></div><div class="ttdoc">Templated n-dimensional image class.</div><div class="ttdef"><b>Definition:</b> <a href="itkImage_8h_source.html#l00088">itkImage.h:88</a></div></div>
<div class="ttc" id="aclassitk_1_1EventObject_html"><div class="ttname"><a href="classitk_1_1EventObject.html">itk::EventObject</a></div><div class="ttdoc">Abstraction of the Events used to communicating among filters and with GUIs.</div><div class="ttdef"><b>Definition:</b> <a href="itkEventObject_8h_source.html#l00057">itkEventObject.h:57</a></div></div>
<div class="ttc" id="aclassitk_1_1OnePlusOneEvolutionaryOptimizer_html"><div class="ttname"><a href="classitk_1_1OnePlusOneEvolutionaryOptimizer.html">itk::OnePlusOneEvolutionaryOptimizer</a></div><div class="ttdoc">1+1 evolutionary strategy optimizer</div><div class="ttdef"><b>Definition:</b> <a href="itkOnePlusOneEvolutionaryOptimizer_8h_source.html#l00071">itkOnePlusOneEvolutionaryOptimizer.h:71</a></div></div>
<div class="ttc" id="aclassitk_1_1SingleValuedCostFunction_html_a3040b706e83393aa406681524a5851e7"><div class="ttname"><a href="classitk_1_1SingleValuedCostFunction.html#a3040b706e83393aa406681524a5851e7">itk::SingleValuedCostFunction::DerivativeType</a></div><div class="ttdeci">Array&lt; ParametersValueType &gt; DerivativeType</div><div class="ttdef"><b>Definition:</b> <a href="itkSingleValuedCostFunction_8h_source.html#l00059">itkSingleValuedCostFunction.h:59</a></div></div>
<div class="ttc" id="aclassitk_1_1GroupSpatialObject_html"><div class="ttname"><a href="classitk_1_1GroupSpatialObject.html">itk::GroupSpatialObject</a></div><div class="ttdoc">Representation of a group based on the spatial object classes.</div><div class="ttdef"><b>Definition:</b> <a href="itkGroupSpatialObject_8h_source.html#l00039">itkGroupSpatialObject.h:39</a></div></div>
<div class="ttc" id="aitkCommand_8h_html"><div class="ttname"><a href="itkCommand_8h.html">itkCommand.h</a></div></div>
<div class="ttc" id="aitkDiscreteGaussianImageFilter_8h_html"><div class="ttname"><a href="itkDiscreteGaussianImageFilter_8h.html">itkDiscreteGaussianImageFilter.h</a></div></div>
<div class="ttc" id="aclassitk_1_1ImageToSpatialObjectMetric_html"><div class="ttname"><a href="classitk_1_1ImageToSpatialObjectMetric.html">itk::ImageToSpatialObjectMetric</a></div><div class="ttdoc">Computes similarity between a moving spatial object and an Image to be registered.</div><div class="ttdef"><b>Definition:</b> <a href="itkImageToSpatialObjectMetric_8h_source.html#l00060">itkImageToSpatialObjectMetric.h:60</a></div></div>
<div class="ttc" id="aclassitk_1_1Statistics_1_1NormalVariateGenerator_html_a07a6a6afa0d73ee0c08f9e4e2bae1698"><div class="ttname"><a href="classitk_1_1Statistics_1_1NormalVariateGenerator.html#a07a6a6afa0d73ee0c08f9e4e2bae1698">itk::Statistics::NormalVariateGenerator::New</a></div><div class="ttdeci">static Pointer New()</div></div>
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<hr class="footer"/>
<div class="footer" align="left">
  <small>Tarballs of the nightly generated Doxygen documentation are available
    for the
    <a href="http://public.kitware.com/pub/itk/NightlyDoxygen/InsightDoxygenDocHtml.tar.gz">html</a>,
    <a href="http://public.kitware.com/pub/itk/NightlyDoxygen/InsightDoxygenDocXml.tar.gz">xml</a>, and
    <a href="http://public.kitware.com/pub/itk/NightlyDoxygen/InsightDoxygenDocTag.gz">tag file</a>.
  </small>
</div>
<address class="footer"><small>
Generated on <span id="datetime">unknown</span> for ITK by &#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
